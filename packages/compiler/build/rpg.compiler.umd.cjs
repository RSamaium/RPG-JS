(function(Qe,pe){typeof exports=="object"&&typeof module<"u"?pe(exports):typeof define=="function"&&define.amd?define(["exports"],pe):(Qe=typeof globalThis<"u"?globalThis:Qe||self,pe(Qe.RpgCompiler={}))})(this,function(Qe){"use strict";const pe={existsSync:(...e)=>window.fs.existsSync(...e),readFileSync:(...e)=>window.fs.readFileSync(...e),readdirSync:(...e)=>window.fs.readdirSync(...e),copyFileSync:(...e)=>window.fs.copyFileSync(...e)};function In(e,t){for(var r=0,n=e.length-1;n>=0;n--){var a=e[n];a==="."?e.splice(n,1):a===".."?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var cs=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,jr=function(e){return cs.exec(e).slice(1)};function Rr(){for(var e="",t=!1,r=arguments.length-1;r>=-1&&!t;r--){var n=r>=0?arguments[r]:"/";if(typeof n!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!n)continue;e=n+"/"+e,t=n.charAt(0)==="/"}return e=In(Ir(e.split("/"),function(a){return!!a}),!t).join("/"),(t?"/":"")+e||"."}function kn(e){var t=Dn(e),r=ys(e,-1)==="/";return e=In(Ir(e.split("/"),function(n){return!!n}),!t).join("/"),!e&&!t&&(e="."),e&&r&&(e+="/"),(t?"/":"")+e}function Dn(e){return e.charAt(0)==="/"}function ls(){var e=Array.prototype.slice.call(arguments,0);return kn(Ir(e,function(t,r){if(typeof t!="string")throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))}function us(e,t){e=Rr(e).substr(1),t=Rr(t).substr(1);function r(u){for(var i=0;i<u.length&&u[i]==="";i++);for(var p=u.length-1;p>=0&&u[p]==="";p--);return i>p?[]:u.slice(i,p-i+1)}for(var n=r(e.split("/")),a=r(t.split("/")),s=Math.min(n.length,a.length),l=s,f=0;f<s;f++)if(n[f]!==a[f]){l=f;break}for(var d=[],f=l;f<n.length;f++)d.push("..");return d=d.concat(a.slice(l)),d.join("/")}var ds="/",fs=":";function ps(e){var t=jr(e),r=t[0],n=t[1];return!r&&!n?".":(n&&(n=n.substr(0,n.length-1)),r+n)}function ms(e,t){var r=jr(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r}function hs(e){return jr(e)[3]}const me={extname:hs,basename:ms,dirname:ps,sep:ds,delimiter:fs,relative:us,join:ls,isAbsolute:Dn,normalize:kn,resolve:Rr};function Ir(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}var ys="ab".substr(-1)==="b"?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)};const vs=e=>window.imagesLoaded[e];var $s=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function An(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Nt={},gs={get exports(){return Nt},set exports(e){Nt=e}},Mn={},Ne={},lt={},Tt={},J={},Ct={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.regexpCode=e.getEsmExportName=e.getProperty=e.safeStringify=e.stringify=e.strConcat=e.addCodeArg=e.str=e._=e.nil=e._Code=e.Name=e.IDENTIFIER=e._CodeOrName=void 0;class t{}e._CodeOrName=t,e.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;class r extends t{constructor(P){if(super(),!e.IDENTIFIER.test(P))throw new Error("CodeGen: name must be a valid identifier");this.str=P}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}}e.Name=r;class n extends t{constructor(P){super(),this._items=typeof P=="string"?[P]:P}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;const P=this._items[0];return P===""||P==='""'}get str(){var P;return(P=this._str)!==null&&P!==void 0?P:this._str=this._items.reduce((O,R)=>`${O}${R}`,"")}get names(){var P;return(P=this._names)!==null&&P!==void 0?P:this._names=this._items.reduce((O,R)=>(R instanceof r&&(O[R.str]=(O[R.str]||0)+1),O),{})}}e._Code=n,e.nil=new n("");function a(h,...P){const O=[h[0]];let R=0;for(;R<P.length;)f(O,P[R]),O.push(h[++R]);return new n(O)}e._=a;const s=new n("+");function l(h,...P){const O=[w(h[0])];let R=0;for(;R<P.length;)O.push(s),f(O,P[R]),O.push(s,w(h[++R]));return d(O),new n(O)}e.str=l;function f(h,P){P instanceof n?h.push(...P._items):P instanceof r?h.push(P):h.push(p(P))}e.addCodeArg=f;function d(h){let P=1;for(;P<h.length-1;){if(h[P]===s){const O=u(h[P-1],h[P+1]);if(O!==void 0){h.splice(P-1,3,O);continue}h[P++]="+"}P++}}function u(h,P){if(P==='""')return h;if(h==='""')return P;if(typeof h=="string")return P instanceof r||h[h.length-1]!=='"'?void 0:typeof P!="string"?`${h.slice(0,-1)}${P}"`:P[0]==='"'?h.slice(0,-1)+P.slice(1):void 0;if(typeof P=="string"&&P[0]==='"'&&!(h instanceof r))return`"${h}${P.slice(1)}`}function i(h,P){return P.emptyStr()?h:h.emptyStr()?P:l`${h}${P}`}e.strConcat=i;function p(h){return typeof h=="number"||typeof h=="boolean"||h===null?h:w(Array.isArray(h)?h.join(","):h)}function b(h){return new n(w(h))}e.stringify=b;function w(h){return JSON.stringify(h).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}e.safeStringify=w;function g(h){return typeof h=="string"&&e.IDENTIFIER.test(h)?new n(`.${h}`):a`[${h}]`}e.getProperty=g;function _(h){if(typeof h=="string"&&e.IDENTIFIER.test(h))return new n(`${h}`);throw new Error(`CodeGen: invalid export name: ${h}, use explicit $id name mapping`)}e.getEsmExportName=_;function $(h){return new n(h.toString())}e.regexpCode=$})(Ct);var kr={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ValueScope=e.ValueScopeName=e.Scope=e.varKinds=e.UsedValueState=void 0;const t=Ct;class r extends Error{constructor(u){super(`CodeGen: "code" for ${u} not defined`),this.value=u.value}}var n;(function(d){d[d.Started=0]="Started",d[d.Completed=1]="Completed"})(n=e.UsedValueState||(e.UsedValueState={})),e.varKinds={const:new t.Name("const"),let:new t.Name("let"),var:new t.Name("var")};class a{constructor({prefixes:u,parent:i}={}){this._names={},this._prefixes=u,this._parent=i}toName(u){return u instanceof t.Name?u:this.name(u)}name(u){return new t.Name(this._newName(u))}_newName(u){const i=this._names[u]||this._nameGroup(u);return`${u}${i.index++}`}_nameGroup(u){var i,p;if(!((p=(i=this._parent)===null||i===void 0?void 0:i._prefixes)===null||p===void 0)&&p.has(u)||this._prefixes&&!this._prefixes.has(u))throw new Error(`CodeGen: prefix "${u}" is not allowed in this scope`);return this._names[u]={prefix:u,index:0}}}e.Scope=a;class s extends t.Name{constructor(u,i){super(i),this.prefix=u}setValue(u,{property:i,itemIndex:p}){this.value=u,this.scopePath=(0,t._)`.${new t.Name(i)}[${p}]`}}e.ValueScopeName=s;const l=(0,t._)`\n`;class f extends a{constructor(u){super(u),this._values={},this._scope=u.scope,this.opts={...u,_n:u.lines?l:t.nil}}get(){return this._scope}name(u){return new s(u,this._newName(u))}value(u,i){var p;if(i.ref===void 0)throw new Error("CodeGen: ref must be passed in value");const b=this.toName(u),{prefix:w}=b,g=(p=i.key)!==null&&p!==void 0?p:i.ref;let _=this._values[w];if(_){const P=_.get(g);if(P)return P}else _=this._values[w]=new Map;_.set(g,b);const $=this._scope[w]||(this._scope[w]=[]),h=$.length;return $[h]=i.ref,b.setValue(i,{property:w,itemIndex:h}),b}getValue(u,i){const p=this._values[u];if(p)return p.get(i)}scopeRefs(u,i=this._values){return this._reduceValues(i,p=>{if(p.scopePath===void 0)throw new Error(`CodeGen: name "${p}" has no value`);return(0,t._)`${u}${p.scopePath}`})}scopeCode(u=this._values,i,p){return this._reduceValues(u,b=>{if(b.value===void 0)throw new Error(`CodeGen: name "${b}" has no value`);return b.value.code},i,p)}_reduceValues(u,i,p={},b){let w=t.nil;for(const g in u){const _=u[g];if(!_)continue;const $=p[g]=p[g]||new Map;_.forEach(h=>{if($.has(h))return;$.set(h,n.Started);let P=i(h);if(P){const O=this.opts.es5?e.varKinds.var:e.varKinds.const;w=(0,t._)`${w}${O} ${h} = ${P};${this.opts._n}`}else if(P=b==null?void 0:b(h))w=(0,t._)`${w}${P}${this.opts._n}`;else throw new r(h);$.set(h,n.Completed)})}return w}}e.ValueScope=f})(kr),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.or=e.and=e.not=e.CodeGen=e.operators=e.varKinds=e.ValueScopeName=e.ValueScope=e.Scope=e.Name=e.regexpCode=e.stringify=e.getProperty=e.nil=e.strConcat=e.str=e._=void 0;const t=Ct,r=kr;var n=Ct;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return n._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return n.str}}),Object.defineProperty(e,"strConcat",{enumerable:!0,get:function(){return n.strConcat}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return n.nil}}),Object.defineProperty(e,"getProperty",{enumerable:!0,get:function(){return n.getProperty}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return n.stringify}}),Object.defineProperty(e,"regexpCode",{enumerable:!0,get:function(){return n.regexpCode}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return n.Name}});var a=kr;Object.defineProperty(e,"Scope",{enumerable:!0,get:function(){return a.Scope}}),Object.defineProperty(e,"ValueScope",{enumerable:!0,get:function(){return a.ValueScope}}),Object.defineProperty(e,"ValueScopeName",{enumerable:!0,get:function(){return a.ValueScopeName}}),Object.defineProperty(e,"varKinds",{enumerable:!0,get:function(){return a.varKinds}}),e.operators={GT:new t._Code(">"),GTE:new t._Code(">="),LT:new t._Code("<"),LTE:new t._Code("<="),EQ:new t._Code("==="),NEQ:new t._Code("!=="),NOT:new t._Code("!"),OR:new t._Code("||"),AND:new t._Code("&&"),ADD:new t._Code("+")};class s{optimizeNodes(){return this}optimizeNames(o,y){return this}}class l extends s{constructor(o,y,I){super(),this.varKind=o,this.name=y,this.rhs=I}render({es5:o,_n:y}){const I=o?r.varKinds.var:this.varKind,z=this.rhs===void 0?"":` = ${this.rhs}`;return`${I} ${this.name}${z};`+y}optimizeNames(o,y){if(o[this.name.str])return this.rhs&&(this.rhs=ne(this.rhs,o,y)),this}get names(){return this.rhs instanceof t._CodeOrName?this.rhs.names:{}}}class f extends s{constructor(o,y,I){super(),this.lhs=o,this.rhs=y,this.sideEffects=I}render({_n:o}){return`${this.lhs} = ${this.rhs};`+o}optimizeNames(o,y){if(!(this.lhs instanceof t.Name&&!o[this.lhs.str]&&!this.sideEffects))return this.rhs=ne(this.rhs,o,y),this}get names(){const o=this.lhs instanceof t.Name?{}:{...this.lhs.names};return de(o,this.rhs)}}class d extends f{constructor(o,y,I,z){super(o,I,z),this.op=y}render({_n:o}){return`${this.lhs} ${this.op}= ${this.rhs};`+o}}class u extends s{constructor(o){super(),this.label=o,this.names={}}render({_n:o}){return`${this.label}:`+o}}class i extends s{constructor(o){super(),this.label=o,this.names={}}render({_n:o}){return`break${this.label?` ${this.label}`:""};`+o}}class p extends s{constructor(o){super(),this.error=o}render({_n:o}){return`throw ${this.error};`+o}get names(){return this.error.names}}class b extends s{constructor(o){super(),this.code=o}render({_n:o}){return`${this.code};`+o}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(o,y){return this.code=ne(this.code,o,y),this}get names(){return this.code instanceof t._CodeOrName?this.code.names:{}}}class w extends s{constructor(o=[]){super(),this.nodes=o}render(o){return this.nodes.reduce((y,I)=>y+I.render(o),"")}optimizeNodes(){const{nodes:o}=this;let y=o.length;for(;y--;){const I=o[y].optimizeNodes();Array.isArray(I)?o.splice(y,1,...I):I?o[y]=I:o.splice(y,1)}return o.length>0?this:void 0}optimizeNames(o,y){const{nodes:I}=this;let z=I.length;for(;z--;){const F=I[z];F.optimizeNames(o,y)||(Se(o,F.names),I.splice(z,1))}return I.length>0?this:void 0}get names(){return this.nodes.reduce((o,y)=>H(o,y.names),{})}}class g extends w{render(o){return"{"+o._n+super.render(o)+"}"+o._n}}class _ extends w{}class $ extends g{}$.kind="else";class h extends g{constructor(o,y){super(y),this.condition=o}render(o){let y=`if(${this.condition})`+super.render(o);return this.else&&(y+="else "+this.else.render(o)),y}optimizeNodes(){super.optimizeNodes();const o=this.condition;if(o===!0)return this.nodes;let y=this.else;if(y){const I=y.optimizeNodes();y=this.else=Array.isArray(I)?new $(I):I}if(y)return o===!1?y instanceof h?y:y.nodes:this.nodes.length?this:new h(at(o),y instanceof h?[y]:y.nodes);if(!(o===!1||!this.nodes.length))return this}optimizeNames(o,y){var I;if(this.else=(I=this.else)===null||I===void 0?void 0:I.optimizeNames(o,y),!!(super.optimizeNames(o,y)||this.else))return this.condition=ne(this.condition,o,y),this}get names(){const o=super.names;return de(o,this.condition),this.else&&H(o,this.else.names),o}}h.kind="if";class P extends g{}P.kind="for";class O extends P{constructor(o){super(),this.iteration=o}render(o){return`for(${this.iteration})`+super.render(o)}optimizeNames(o,y){if(super.optimizeNames(o,y))return this.iteration=ne(this.iteration,o,y),this}get names(){return H(super.names,this.iteration.names)}}class R extends P{constructor(o,y,I,z){super(),this.varKind=o,this.name=y,this.from=I,this.to=z}render(o){const y=o.es5?r.varKinds.var:this.varKind,{name:I,from:z,to:F}=this;return`for(${y} ${I}=${z}; ${I}<${F}; ${I}++)`+super.render(o)}get names(){const o=de(super.names,this.from);return de(o,this.to)}}class D extends P{constructor(o,y,I,z){super(),this.loop=o,this.varKind=y,this.name=I,this.iterable=z}render(o){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(o)}optimizeNames(o,y){if(super.optimizeNames(o,y))return this.iterable=ne(this.iterable,o,y),this}get names(){return H(super.names,this.iterable.names)}}class E extends g{constructor(o,y,I){super(),this.name=o,this.args=y,this.async=I}render(o){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(o)}}E.kind="func";class j extends w{render(o){return"return "+super.render(o)}}j.kind="return";class A extends g{render(o){let y="try"+super.render(o);return this.catch&&(y+=this.catch.render(o)),this.finally&&(y+=this.finally.render(o)),y}optimizeNodes(){var o,y;return super.optimizeNodes(),(o=this.catch)===null||o===void 0||o.optimizeNodes(),(y=this.finally)===null||y===void 0||y.optimizeNodes(),this}optimizeNames(o,y){var I,z;return super.optimizeNames(o,y),(I=this.catch)===null||I===void 0||I.optimizeNames(o,y),(z=this.finally)===null||z===void 0||z.optimizeNames(o,y),this}get names(){const o=super.names;return this.catch&&H(o,this.catch.names),this.finally&&H(o,this.finally.names),o}}class M extends g{constructor(o){super(),this.error=o}render(o){return`catch(${this.error})`+super.render(o)}}M.kind="catch";class U extends g{render(o){return"finally"+super.render(o)}}U.kind="finally";class B{constructor(o,y={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...y,_n:y.lines?`
`:""},this._extScope=o,this._scope=new r.Scope({parent:o}),this._nodes=[new _]}toString(){return this._root.render(this.opts)}name(o){return this._scope.name(o)}scopeName(o){return this._extScope.name(o)}scopeValue(o,y){const I=this._extScope.value(o,y);return(this._values[I.prefix]||(this._values[I.prefix]=new Set)).add(I),I}getScopeValue(o,y){return this._extScope.getValue(o,y)}scopeRefs(o){return this._extScope.scopeRefs(o,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(o,y,I,z){const F=this._scope.toName(y);return I!==void 0&&z&&(this._constants[F.str]=I),this._leafNode(new l(o,F,I)),F}const(o,y,I){return this._def(r.varKinds.const,o,y,I)}let(o,y,I){return this._def(r.varKinds.let,o,y,I)}var(o,y,I){return this._def(r.varKinds.var,o,y,I)}assign(o,y,I){return this._leafNode(new f(o,y,I))}add(o,y){return this._leafNode(new d(o,e.operators.ADD,y))}code(o){return typeof o=="function"?o():o!==t.nil&&this._leafNode(new b(o)),this}object(...o){const y=["{"];for(const[I,z]of o)y.length>1&&y.push(","),y.push(I),(I!==z||this.opts.es5)&&(y.push(":"),(0,t.addCodeArg)(y,z));return y.push("}"),new t._Code(y)}if(o,y,I){if(this._blockNode(new h(o)),y&&I)this.code(y).else().code(I).endIf();else if(y)this.code(y).endIf();else if(I)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(o){return this._elseNode(new h(o))}else(){return this._elseNode(new $)}endIf(){return this._endBlockNode(h,$)}_for(o,y){return this._blockNode(o),y&&this.code(y).endFor(),this}for(o,y){return this._for(new O(o),y)}forRange(o,y,I,z,F=this.opts.es5?r.varKinds.var:r.varKinds.let){const X=this._scope.toName(o);return this._for(new R(F,X,y,I),()=>z(X))}forOf(o,y,I,z=r.varKinds.const){const F=this._scope.toName(o);if(this.opts.es5){const X=y instanceof t.Name?y:this.var("_arr",y);return this.forRange("_i",0,(0,t._)`${X}.length`,Z=>{this.var(F,(0,t._)`${X}[${Z}]`),I(F)})}return this._for(new D("of",z,F,y),()=>I(F))}forIn(o,y,I,z=this.opts.es5?r.varKinds.var:r.varKinds.const){if(this.opts.ownProperties)return this.forOf(o,(0,t._)`Object.keys(${y})`,I);const F=this._scope.toName(o);return this._for(new D("in",z,F,y),()=>I(F))}endFor(){return this._endBlockNode(P)}label(o){return this._leafNode(new u(o))}break(o){return this._leafNode(new i(o))}return(o){const y=new j;if(this._blockNode(y),this.code(o),y.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(j)}try(o,y,I){if(!y&&!I)throw new Error('CodeGen: "try" without "catch" and "finally"');const z=new A;if(this._blockNode(z),this.code(o),y){const F=this.name("e");this._currNode=z.catch=new M(F),y(F)}return I&&(this._currNode=z.finally=new U,this.code(I)),this._endBlockNode(M,U)}throw(o){return this._leafNode(new p(o))}block(o,y){return this._blockStarts.push(this._nodes.length),o&&this.code(o).endBlock(y),this}endBlock(o){const y=this._blockStarts.pop();if(y===void 0)throw new Error("CodeGen: not in self-balancing block");const I=this._nodes.length-y;if(I<0||o!==void 0&&I!==o)throw new Error(`CodeGen: wrong number of nodes: ${I} vs ${o} expected`);return this._nodes.length=y,this}func(o,y=t.nil,I,z){return this._blockNode(new E(o,y,I)),z&&this.code(z).endFunc(),this}endFunc(){return this._endBlockNode(E)}optimize(o=1){for(;o-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(o){return this._currNode.nodes.push(o),this}_blockNode(o){this._currNode.nodes.push(o),this._nodes.push(o)}_endBlockNode(o,y){const I=this._currNode;if(I instanceof o||y&&I instanceof y)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${y?`${o.kind}/${y.kind}`:o.kind}"`)}_elseNode(o){const y=this._currNode;if(!(y instanceof h))throw new Error('CodeGen: "else" without "if"');return this._currNode=y.else=o,this}get _root(){return this._nodes[0]}get _currNode(){const o=this._nodes;return o[o.length-1]}set _currNode(o){const y=this._nodes;y[y.length-1]=o}}e.CodeGen=B;function H(N,o){for(const y in o)N[y]=(N[y]||0)+(o[y]||0);return N}function de(N,o){return o instanceof t._CodeOrName?H(N,o.names):N}function ne(N,o,y){if(N instanceof t.Name)return I(N);if(!z(N))return N;return new t._Code(N._items.reduce((F,X)=>(X instanceof t.Name&&(X=I(X)),X instanceof t._Code?F.push(...X._items):F.push(X),F),[]));function I(F){const X=y[F.str];return X===void 0||o[F.str]!==1?F:(delete o[F.str],X)}function z(F){return F instanceof t._Code&&F._items.some(X=>X instanceof t.Name&&o[X.str]===1&&y[X.str]!==void 0)}}function Se(N,o){for(const y in o)N[y]=(N[y]||0)-(o[y]||0)}function at(N){return typeof N=="boolean"||typeof N=="number"||N===null?!N:(0,t._)`!${k(N)}`}e.not=at;const $t=S(e.operators.AND);function Kt(...N){return N.reduce($t)}e.and=Kt;const gt=S(e.operators.OR);function V(...N){return N.reduce(gt)}e.or=V;function S(N){return(o,y)=>o===t.nil?y:y===t.nil?o:(0,t._)`${k(o)} ${N} ${k(y)}`}function k(N){return N instanceof t.Name?N:(0,t._)`(${N})`}}(J);var ee={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.checkStrictMode=e.getErrorPath=e.Type=e.useFunc=e.setEvaluated=e.evaluatedPropsToName=e.mergeEvaluated=e.eachItem=e.unescapeJsonPointer=e.escapeJsonPointer=e.escapeFragment=e.unescapeFragment=e.schemaRefOrVal=e.schemaHasRulesButRef=e.schemaHasRules=e.checkUnknownRules=e.alwaysValidSchema=e.toHash=void 0;const t=J,r=Ct;function n(E){const j={};for(const A of E)j[A]=!0;return j}e.toHash=n;function a(E,j){return typeof j=="boolean"?j:Object.keys(j).length===0?!0:(s(E,j),!l(j,E.self.RULES.all))}e.alwaysValidSchema=a;function s(E,j=E.schema){const{opts:A,self:M}=E;if(!A.strictSchema||typeof j=="boolean")return;const U=M.RULES.keywords;for(const B in j)U[B]||D(E,`unknown keyword: "${B}"`)}e.checkUnknownRules=s;function l(E,j){if(typeof E=="boolean")return!E;for(const A in E)if(j[A])return!0;return!1}e.schemaHasRules=l;function f(E,j){if(typeof E=="boolean")return!E;for(const A in E)if(A!=="$ref"&&j.all[A])return!0;return!1}e.schemaHasRulesButRef=f;function d({topSchemaRef:E,schemaPath:j},A,M,U){if(!U){if(typeof A=="number"||typeof A=="boolean")return A;if(typeof A=="string")return(0,t._)`${A}`}return(0,t._)`${E}${j}${(0,t.getProperty)(M)}`}e.schemaRefOrVal=d;function u(E){return b(decodeURIComponent(E))}e.unescapeFragment=u;function i(E){return encodeURIComponent(p(E))}e.escapeFragment=i;function p(E){return typeof E=="number"?`${E}`:E.replace(/~/g,"~0").replace(/\//g,"~1")}e.escapeJsonPointer=p;function b(E){return E.replace(/~1/g,"/").replace(/~0/g,"~")}e.unescapeJsonPointer=b;function w(E,j){if(Array.isArray(E))for(const A of E)j(A);else j(E)}e.eachItem=w;function g({mergeNames:E,mergeToName:j,mergeValues:A,resultToName:M}){return(U,B,H,de)=>{const ne=H===void 0?B:H instanceof t.Name?(B instanceof t.Name?E(U,B,H):j(U,B,H),H):B instanceof t.Name?(j(U,H,B),B):A(B,H);return de===t.Name&&!(ne instanceof t.Name)?M(U,ne):ne}}e.mergeEvaluated={props:g({mergeNames:(E,j,A)=>E.if((0,t._)`${A} !== true && ${j} !== undefined`,()=>{E.if((0,t._)`${j} === true`,()=>E.assign(A,!0),()=>E.assign(A,(0,t._)`${A} || {}`).code((0,t._)`Object.assign(${A}, ${j})`))}),mergeToName:(E,j,A)=>E.if((0,t._)`${A} !== true`,()=>{j===!0?E.assign(A,!0):(E.assign(A,(0,t._)`${A} || {}`),$(E,A,j))}),mergeValues:(E,j)=>E===!0?!0:{...E,...j},resultToName:_}),items:g({mergeNames:(E,j,A)=>E.if((0,t._)`${A} !== true && ${j} !== undefined`,()=>E.assign(A,(0,t._)`${j} === true ? true : ${A} > ${j} ? ${A} : ${j}`)),mergeToName:(E,j,A)=>E.if((0,t._)`${A} !== true`,()=>E.assign(A,j===!0?!0:(0,t._)`${A} > ${j} ? ${A} : ${j}`)),mergeValues:(E,j)=>E===!0?!0:Math.max(E,j),resultToName:(E,j)=>E.var("items",j)})};function _(E,j){if(j===!0)return E.var("props",!0);const A=E.var("props",(0,t._)`{}`);return j!==void 0&&$(E,A,j),A}e.evaluatedPropsToName=_;function $(E,j,A){Object.keys(A).forEach(M=>E.assign((0,t._)`${j}${(0,t.getProperty)(M)}`,!0))}e.setEvaluated=$;const h={};function P(E,j){return E.scopeValue("func",{ref:j,code:h[j.code]||(h[j.code]=new r._Code(j.code))})}e.useFunc=P;var O;(function(E){E[E.Num=0]="Num",E[E.Str=1]="Str"})(O=e.Type||(e.Type={}));function R(E,j,A){if(E instanceof t.Name){const M=j===O.Num;return A?M?(0,t._)`"[" + ${E} + "]"`:(0,t._)`"['" + ${E} + "']"`:M?(0,t._)`"/" + ${E}`:(0,t._)`"/" + ${E}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return A?(0,t.getProperty)(E).toString():"/"+p(E)}e.getErrorPath=R;function D(E,j,A=E.opts.strictSchema){if(A){if(j=`strict mode: ${j}`,A===!0)throw new Error(j);E.self.logger.warn(j)}}e.checkStrictMode=D})(ee);var Re={};Object.defineProperty(Re,"__esModule",{value:!0});const ve=J,_s={data:new ve.Name("data"),valCxt:new ve.Name("valCxt"),instancePath:new ve.Name("instancePath"),parentData:new ve.Name("parentData"),parentDataProperty:new ve.Name("parentDataProperty"),rootData:new ve.Name("rootData"),dynamicAnchors:new ve.Name("dynamicAnchors"),vErrors:new ve.Name("vErrors"),errors:new ve.Name("errors"),this:new ve.Name("this"),self:new ve.Name("self"),scope:new ve.Name("scope"),json:new ve.Name("json"),jsonPos:new ve.Name("jsonPos"),jsonLen:new ve.Name("jsonLen"),jsonPart:new ve.Name("jsonPart")};Re.default=_s,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.extendErrors=e.resetErrorsCount=e.reportExtraError=e.reportError=e.keyword$DataError=e.keywordError=void 0;const t=J,r=ee,n=Re;e.keywordError={message:({keyword:$})=>(0,t.str)`must pass "${$}" keyword validation`},e.keyword$DataError={message:({keyword:$,schemaType:h})=>h?(0,t.str)`"${$}" keyword must be ${h} ($data)`:(0,t.str)`"${$}" keyword is invalid ($data)`};function a($,h=e.keywordError,P,O){const{it:R}=$,{gen:D,compositeRule:E,allErrors:j}=R,A=p($,h,P);O??(E||j)?d(D,A):u(R,(0,t._)`[${A}]`)}e.reportError=a;function s($,h=e.keywordError,P){const{it:O}=$,{gen:R,compositeRule:D,allErrors:E}=O,j=p($,h,P);d(R,j),D||E||u(O,n.default.vErrors)}e.reportExtraError=s;function l($,h){$.assign(n.default.errors,h),$.if((0,t._)`${n.default.vErrors} !== null`,()=>$.if(h,()=>$.assign((0,t._)`${n.default.vErrors}.length`,h),()=>$.assign(n.default.vErrors,null)))}e.resetErrorsCount=l;function f({gen:$,keyword:h,schemaValue:P,data:O,errsCount:R,it:D}){if(R===void 0)throw new Error("ajv implementation error");const E=$.name("err");$.forRange("i",R,n.default.errors,j=>{$.const(E,(0,t._)`${n.default.vErrors}[${j}]`),$.if((0,t._)`${E}.instancePath === undefined`,()=>$.assign((0,t._)`${E}.instancePath`,(0,t.strConcat)(n.default.instancePath,D.errorPath))),$.assign((0,t._)`${E}.schemaPath`,(0,t.str)`${D.errSchemaPath}/${h}`),D.opts.verbose&&($.assign((0,t._)`${E}.schema`,P),$.assign((0,t._)`${E}.data`,O))})}e.extendErrors=f;function d($,h){const P=$.const("err",h);$.if((0,t._)`${n.default.vErrors} === null`,()=>$.assign(n.default.vErrors,(0,t._)`[${P}]`),(0,t._)`${n.default.vErrors}.push(${P})`),$.code((0,t._)`${n.default.errors}++`)}function u($,h){const{gen:P,validateName:O,schemaEnv:R}=$;R.$async?P.throw((0,t._)`new ${$.ValidationError}(${h})`):(P.assign((0,t._)`${O}.errors`,h),P.return(!1))}const i={keyword:new t.Name("keyword"),schemaPath:new t.Name("schemaPath"),params:new t.Name("params"),propertyName:new t.Name("propertyName"),message:new t.Name("message"),schema:new t.Name("schema"),parentSchema:new t.Name("parentSchema")};function p($,h,P){const{createErrors:O}=$.it;return O===!1?(0,t._)`{}`:b($,h,P)}function b($,h,P={}){const{gen:O,it:R}=$,D=[w(R,P),g($,P)];return _($,h,D),O.object(...D)}function w({errorPath:$},{instancePath:h}){const P=h?(0,t.str)`${$}${(0,r.getErrorPath)(h,r.Type.Str)}`:$;return[n.default.instancePath,(0,t.strConcat)(n.default.instancePath,P)]}function g({keyword:$,it:{errSchemaPath:h}},{schemaPath:P,parentSchema:O}){let R=O?h:(0,t.str)`${h}/${$}`;return P&&(R=(0,t.str)`${R}${(0,r.getErrorPath)(P,r.Type.Str)}`),[i.schemaPath,R]}function _($,{params:h,message:P},O){const{keyword:R,data:D,schemaValue:E,it:j}=$,{opts:A,propertyName:M,topSchemaRef:U,schemaPath:B}=j;O.push([i.keyword,R],[i.params,typeof h=="function"?h($):h||(0,t._)`{}`]),A.messages&&O.push([i.message,typeof P=="function"?P($):P]),A.verbose&&O.push([i.schema,E],[i.parentSchema,(0,t._)`${U}${B}`],[n.default.data,D]),M&&O.push([i.propertyName,M])}}(Tt),Object.defineProperty(lt,"__esModule",{value:!0}),lt.boolOrEmptySchema=lt.topBoolOrEmptySchema=void 0;const ws=Tt,bs=J,Es=Re,Ss={message:"boolean schema is false"};function Ps(e){const{gen:t,schema:r,validateName:n}=e;r===!1?Vn(e,!1):typeof r=="object"&&r.$async===!0?t.return(Es.default.data):(t.assign((0,bs._)`${n}.errors`,null),t.return(!0))}lt.topBoolOrEmptySchema=Ps;function Os(e,t){const{gen:r,schema:n}=e;n===!1?(r.var(t,!1),Vn(e)):r.var(t,!0)}lt.boolOrEmptySchema=Os;function Vn(e,t){const{gen:r,data:n}=e,a={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:e};(0,ws.reportError)(a,Ss,void 0,t)}var jt={},Ze={};Object.defineProperty(Ze,"__esModule",{value:!0}),Ze.getRules=Ze.isJSONType=void 0;const Ns=["string","number","integer","boolean","null","object","array"],Ts=new Set(Ns);function Cs(e){return typeof e=="string"&&Ts.has(e)}Ze.isJSONType=Cs;function js(){const e={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...e,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},e.number,e.string,e.array,e.object],post:{rules:[]},all:{},keywords:{}}}Ze.getRules=js;var Le={};Object.defineProperty(Le,"__esModule",{value:!0}),Le.shouldUseRule=Le.shouldUseGroup=Le.schemaHasRulesForType=void 0;function Rs({schema:e,self:t},r){const n=t.RULES.types[r];return n&&n!==!0&&zn(e,n)}Le.schemaHasRulesForType=Rs;function zn(e,t){return t.rules.some(r=>Fn(e,r))}Le.shouldUseGroup=zn;function Fn(e,t){var r;return e[t.keyword]!==void 0||((r=t.definition.implements)===null||r===void 0?void 0:r.some(n=>e[n]!==void 0))}Le.shouldUseRule=Fn,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.reportTypeError=e.checkDataTypes=e.checkDataType=e.coerceAndCheckDataType=e.getJSONTypes=e.getSchemaTypes=e.DataType=void 0;const t=Ze,r=Le,n=Tt,a=J,s=ee;var l;(function(O){O[O.Correct=0]="Correct",O[O.Wrong=1]="Wrong"})(l=e.DataType||(e.DataType={}));function f(O){const R=d(O.type);if(R.includes("null")){if(O.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!R.length&&O.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');O.nullable===!0&&R.push("null")}return R}e.getSchemaTypes=f;function d(O){const R=Array.isArray(O)?O:O?[O]:[];if(R.every(t.isJSONType))return R;throw new Error("type must be JSONType or JSONType[]: "+R.join(","))}e.getJSONTypes=d;function u(O,R){const{gen:D,data:E,opts:j}=O,A=p(R,j.coerceTypes),M=R.length>0&&!(A.length===0&&R.length===1&&(0,r.schemaHasRulesForType)(O,R[0]));if(M){const U=_(R,E,j.strictNumbers,l.Wrong);D.if(U,()=>{A.length?b(O,R,A):h(O)})}return M}e.coerceAndCheckDataType=u;const i=new Set(["string","number","integer","boolean","null"]);function p(O,R){return R?O.filter(D=>i.has(D)||R==="array"&&D==="array"):[]}function b(O,R,D){const{gen:E,data:j,opts:A}=O,M=E.let("dataType",(0,a._)`typeof ${j}`),U=E.let("coerced",(0,a._)`undefined`);A.coerceTypes==="array"&&E.if((0,a._)`${M} == 'object' && Array.isArray(${j}) && ${j}.length == 1`,()=>E.assign(j,(0,a._)`${j}[0]`).assign(M,(0,a._)`typeof ${j}`).if(_(R,j,A.strictNumbers),()=>E.assign(U,j))),E.if((0,a._)`${U} !== undefined`);for(const H of D)(i.has(H)||H==="array"&&A.coerceTypes==="array")&&B(H);E.else(),h(O),E.endIf(),E.if((0,a._)`${U} !== undefined`,()=>{E.assign(j,U),w(O,U)});function B(H){switch(H){case"string":E.elseIf((0,a._)`${M} == "number" || ${M} == "boolean"`).assign(U,(0,a._)`"" + ${j}`).elseIf((0,a._)`${j} === null`).assign(U,(0,a._)`""`);return;case"number":E.elseIf((0,a._)`${M} == "boolean" || ${j} === null
              || (${M} == "string" && ${j} && ${j} == +${j})`).assign(U,(0,a._)`+${j}`);return;case"integer":E.elseIf((0,a._)`${M} === "boolean" || ${j} === null
              || (${M} === "string" && ${j} && ${j} == +${j} && !(${j} % 1))`).assign(U,(0,a._)`+${j}`);return;case"boolean":E.elseIf((0,a._)`${j} === "false" || ${j} === 0 || ${j} === null`).assign(U,!1).elseIf((0,a._)`${j} === "true" || ${j} === 1`).assign(U,!0);return;case"null":E.elseIf((0,a._)`${j} === "" || ${j} === 0 || ${j} === false`),E.assign(U,null);return;case"array":E.elseIf((0,a._)`${M} === "string" || ${M} === "number"
              || ${M} === "boolean" || ${j} === null`).assign(U,(0,a._)`[${j}]`)}}}function w({gen:O,parentData:R,parentDataProperty:D},E){O.if((0,a._)`${R} !== undefined`,()=>O.assign((0,a._)`${R}[${D}]`,E))}function g(O,R,D,E=l.Correct){const j=E===l.Correct?a.operators.EQ:a.operators.NEQ;let A;switch(O){case"null":return(0,a._)`${R} ${j} null`;case"array":A=(0,a._)`Array.isArray(${R})`;break;case"object":A=(0,a._)`${R} && typeof ${R} == "object" && !Array.isArray(${R})`;break;case"integer":A=M((0,a._)`!(${R} % 1) && !isNaN(${R})`);break;case"number":A=M();break;default:return(0,a._)`typeof ${R} ${j} ${O}`}return E===l.Correct?A:(0,a.not)(A);function M(U=a.nil){return(0,a.and)((0,a._)`typeof ${R} == "number"`,U,D?(0,a._)`isFinite(${R})`:a.nil)}}e.checkDataType=g;function _(O,R,D,E){if(O.length===1)return g(O[0],R,D,E);let j;const A=(0,s.toHash)(O);if(A.array&&A.object){const M=(0,a._)`typeof ${R} != "object"`;j=A.null?M:(0,a._)`!${R} || ${M}`,delete A.null,delete A.array,delete A.object}else j=a.nil;A.number&&delete A.integer;for(const M in A)j=(0,a.and)(j,g(M,R,D,E));return j}e.checkDataTypes=_;const $={message:({schema:O})=>`must be ${O}`,params:({schema:O,schemaValue:R})=>typeof O=="string"?(0,a._)`{type: ${O}}`:(0,a._)`{type: ${R}}`};function h(O){const R=P(O);(0,n.reportError)(R,$)}e.reportTypeError=h;function P(O){const{gen:R,data:D,schema:E}=O,j=(0,s.schemaRefOrVal)(O,E,"type");return{gen:R,keyword:"type",data:D,schema:E.type,schemaCode:j,schemaValue:j,parentSchema:E,params:{},it:O}}}(jt);var xt={};Object.defineProperty(xt,"__esModule",{value:!0}),xt.assignDefaults=void 0;const ut=J,Is=ee;function ks(e,t){const{properties:r,items:n}=e.schema;if(t==="object"&&r)for(const a in r)Un(e,a,r[a].default);else t==="array"&&Array.isArray(n)&&n.forEach((a,s)=>Un(e,s,a.default))}xt.assignDefaults=ks;function Un(e,t,r){const{gen:n,compositeRule:a,data:s,opts:l}=e;if(r===void 0)return;const f=(0,ut._)`${s}${(0,ut.getProperty)(t)}`;if(a){(0,Is.checkStrictMode)(e,`default is ignored for: ${f}`);return}let d=(0,ut._)`${f} === undefined`;l.useDefaults==="empty"&&(d=(0,ut._)`${d} || ${f} === null || ${f} === ""`),n.if(d,(0,ut._)`${f} = ${(0,ut.stringify)(r)}`)}var Ie={},Y={};Object.defineProperty(Y,"__esModule",{value:!0}),Y.validateUnion=Y.validateArray=Y.usePattern=Y.callValidateCode=Y.schemaProperties=Y.allSchemaProperties=Y.noPropertyInData=Y.propertyInData=Y.isOwnProperty=Y.hasPropFunc=Y.reportMissingProp=Y.checkMissingProp=Y.checkReportMissingProp=void 0;const re=J,Dr=ee,Ge=Re,Ds=ee;function As(e,t){const{gen:r,data:n,it:a}=e;r.if(Mr(r,n,t,a.opts.ownProperties),()=>{e.setParams({missingProperty:(0,re._)`${t}`},!0),e.error()})}Y.checkReportMissingProp=As;function Ms({gen:e,data:t,it:{opts:r}},n,a){return(0,re.or)(...n.map(s=>(0,re.and)(Mr(e,t,s,r.ownProperties),(0,re._)`${a} = ${s}`)))}Y.checkMissingProp=Ms;function Vs(e,t){e.setParams({missingProperty:t},!0),e.error()}Y.reportMissingProp=Vs;function Ln(e){return e.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,re._)`Object.prototype.hasOwnProperty`})}Y.hasPropFunc=Ln;function Ar(e,t,r){return(0,re._)`${Ln(e)}.call(${t}, ${r})`}Y.isOwnProperty=Ar;function zs(e,t,r,n){const a=(0,re._)`${t}${(0,re.getProperty)(r)} !== undefined`;return n?(0,re._)`${a} && ${Ar(e,t,r)}`:a}Y.propertyInData=zs;function Mr(e,t,r,n){const a=(0,re._)`${t}${(0,re.getProperty)(r)} === undefined`;return n?(0,re.or)(a,(0,re.not)(Ar(e,t,r))):a}Y.noPropertyInData=Mr;function qn(e){return e?Object.keys(e).filter(t=>t!=="__proto__"):[]}Y.allSchemaProperties=qn;function Fs(e,t){return qn(t).filter(r=>!(0,Dr.alwaysValidSchema)(e,t[r]))}Y.schemaProperties=Fs;function Us({schemaCode:e,data:t,it:{gen:r,topSchemaRef:n,schemaPath:a,errorPath:s},it:l},f,d,u){const i=u?(0,re._)`${e}, ${t}, ${n}${a}`:t,p=[[Ge.default.instancePath,(0,re.strConcat)(Ge.default.instancePath,s)],[Ge.default.parentData,l.parentData],[Ge.default.parentDataProperty,l.parentDataProperty],[Ge.default.rootData,Ge.default.rootData]];l.opts.dynamicRef&&p.push([Ge.default.dynamicAnchors,Ge.default.dynamicAnchors]);const b=(0,re._)`${i}, ${r.object(...p)}`;return d!==re.nil?(0,re._)`${f}.call(${d}, ${b})`:(0,re._)`${f}(${b})`}Y.callValidateCode=Us;const Ls=(0,re._)`new RegExp`;function qs({gen:e,it:{opts:t}},r){const n=t.unicodeRegExp?"u":"",{regExp:a}=t.code,s=a(r,n);return e.scopeValue("pattern",{key:s.toString(),ref:s,code:(0,re._)`${a.code==="new RegExp"?Ls:(0,Ds.useFunc)(e,a)}(${r}, ${n})`})}Y.usePattern=qs;function Ks(e){const{gen:t,data:r,keyword:n,it:a}=e,s=t.name("valid");if(a.allErrors){const f=t.let("valid",!0);return l(()=>t.assign(f,!1)),f}return t.var(s,!0),l(()=>t.break()),s;function l(f){const d=t.const("len",(0,re._)`${r}.length`);t.forRange("i",0,d,u=>{e.subschema({keyword:n,dataProp:u,dataPropType:Dr.Type.Num},s),t.if((0,re.not)(s),f)})}}Y.validateArray=Ks;function Hs(e){const{gen:t,schema:r,keyword:n,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(d=>(0,Dr.alwaysValidSchema)(a,d))&&!a.opts.unevaluated)return;const l=t.let("valid",!1),f=t.name("_valid");t.block(()=>r.forEach((d,u)=>{const i=e.subschema({keyword:n,schemaProp:u,compositeRule:!0},f);t.assign(l,(0,re._)`${l} || ${f}`),e.mergeValidEvaluated(i,f)||t.if((0,re.not)(l))})),e.result(l,()=>e.reset(),()=>e.error(!0))}Y.validateUnion=Hs,Object.defineProperty(Ie,"__esModule",{value:!0}),Ie.validateKeywordUsage=Ie.validSchemaType=Ie.funcKeywordCode=Ie.macroKeywordCode=void 0;const $e=J,xe=Re,Gs=Y,Ws=Tt;function Js(e,t){const{gen:r,keyword:n,schema:a,parentSchema:s,it:l}=e,f=t.macro.call(l.self,a,s,l),d=Hn(r,n,f);l.opts.validateSchema!==!1&&l.self.validateSchema(f,!0);const u=r.name("valid");e.subschema({schema:f,schemaPath:$e.nil,errSchemaPath:`${l.errSchemaPath}/${n}`,topSchemaRef:d,compositeRule:!0},u),e.pass(u,()=>e.error(!0))}Ie.macroKeywordCode=Js;function Bs(e,t){var r;const{gen:n,keyword:a,schema:s,parentSchema:l,$data:f,it:d}=e;Xs(d,t);const u=!f&&t.compile?t.compile.call(d.self,s,l,d):t.validate,i=Hn(n,a,u),p=n.let("valid");e.block$data(p,b),e.ok((r=t.valid)!==null&&r!==void 0?r:p);function b(){if(t.errors===!1)_(),t.modifying&&Kn(e),$(()=>e.error());else{const h=t.async?w():g();t.modifying&&Kn(e),$(()=>Ys(e,h))}}function w(){const h=n.let("ruleErrs",null);return n.try(()=>_((0,$e._)`await `),P=>n.assign(p,!1).if((0,$e._)`${P} instanceof ${d.ValidationError}`,()=>n.assign(h,(0,$e._)`${P}.errors`),()=>n.throw(P))),h}function g(){const h=(0,$e._)`${i}.errors`;return n.assign(h,null),_($e.nil),h}function _(h=t.async?(0,$e._)`await `:$e.nil){const P=d.opts.passContext?xe.default.this:xe.default.self,O=!("compile"in t&&!f||t.schema===!1);n.assign(p,(0,$e._)`${h}${(0,Gs.callValidateCode)(e,i,P,O)}`,t.modifying)}function $(h){var P;n.if((0,$e.not)((P=t.valid)!==null&&P!==void 0?P:p),h)}}Ie.funcKeywordCode=Bs;function Kn(e){const{gen:t,data:r,it:n}=e;t.if(n.parentData,()=>t.assign(r,(0,$e._)`${n.parentData}[${n.parentDataProperty}]`))}function Ys(e,t){const{gen:r}=e;r.if((0,$e._)`Array.isArray(${t})`,()=>{r.assign(xe.default.vErrors,(0,$e._)`${xe.default.vErrors} === null ? ${t} : ${xe.default.vErrors}.concat(${t})`).assign(xe.default.errors,(0,$e._)`${xe.default.vErrors}.length`),(0,Ws.extendErrors)(e)},()=>e.error())}function Xs({schemaEnv:e},t){if(t.async&&!e.$async)throw new Error("async keyword in sync schema")}function Hn(e,t,r){if(r===void 0)throw new Error(`keyword "${t}" failed to compile`);return e.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,$e.stringify)(r)})}function Qs(e,t,r=!1){return!t.length||t.some(n=>n==="array"?Array.isArray(e):n==="object"?e&&typeof e=="object"&&!Array.isArray(e):typeof e==n||r&&typeof e>"u")}Ie.validSchemaType=Qs;function Zs({schema:e,opts:t,self:r,errSchemaPath:n},a,s){if(Array.isArray(a.keyword)?!a.keyword.includes(s):a.keyword!==s)throw new Error("ajv implementation error");const l=a.dependencies;if(l!=null&&l.some(f=>!Object.prototype.hasOwnProperty.call(e,f)))throw new Error(`parent schema must have dependencies of ${s}: ${l.join(",")}`);if(a.validateSchema&&!a.validateSchema(e[s])){const d=`keyword "${s}" value is invalid at path "${n}": `+r.errorsText(a.validateSchema.errors);if(t.validateSchema==="log")r.logger.error(d);else throw new Error(d)}}Ie.validateKeywordUsage=Zs;var We={};Object.defineProperty(We,"__esModule",{value:!0}),We.extendSubschemaMode=We.extendSubschemaData=We.getSubschema=void 0;const ke=J,Gn=ee;function xs(e,{keyword:t,schemaProp:r,schema:n,schemaPath:a,errSchemaPath:s,topSchemaRef:l}){if(t!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(t!==void 0){const f=e.schema[t];return r===void 0?{schema:f,schemaPath:(0,ke._)`${e.schemaPath}${(0,ke.getProperty)(t)}`,errSchemaPath:`${e.errSchemaPath}/${t}`}:{schema:f[r],schemaPath:(0,ke._)`${e.schemaPath}${(0,ke.getProperty)(t)}${(0,ke.getProperty)(r)}`,errSchemaPath:`${e.errSchemaPath}/${t}/${(0,Gn.escapeFragment)(r)}`}}if(n!==void 0){if(a===void 0||s===void 0||l===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:a,topSchemaRef:l,errSchemaPath:s}}throw new Error('either "keyword" or "schema" must be passed')}We.getSubschema=xs;function eo(e,t,{dataProp:r,dataPropType:n,data:a,dataTypes:s,propertyName:l}){if(a!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');const{gen:f}=t;if(r!==void 0){const{errorPath:u,dataPathArr:i,opts:p}=t,b=f.let("data",(0,ke._)`${t.data}${(0,ke.getProperty)(r)}`,!0);d(b),e.errorPath=(0,ke.str)`${u}${(0,Gn.getErrorPath)(r,n,p.jsPropertySyntax)}`,e.parentDataProperty=(0,ke._)`${r}`,e.dataPathArr=[...i,e.parentDataProperty]}if(a!==void 0){const u=a instanceof ke.Name?a:f.let("data",a,!0);d(u),l!==void 0&&(e.propertyName=l)}s&&(e.dataTypes=s);function d(u){e.data=u,e.dataLevel=t.dataLevel+1,e.dataTypes=[],t.definedProperties=new Set,e.parentData=t.data,e.dataNames=[...t.dataNames,u]}}We.extendSubschemaData=eo;function to(e,{jtdDiscriminator:t,jtdMetadata:r,compositeRule:n,createErrors:a,allErrors:s}){n!==void 0&&(e.compositeRule=n),a!==void 0&&(e.createErrors=a),s!==void 0&&(e.allErrors=s),e.jtdDiscriminator=t,e.jtdMetadata=r}We.extendSubschemaMode=to;var he={},Wn=function e(t,r){if(t===r)return!0;if(t&&r&&typeof t=="object"&&typeof r=="object"){if(t.constructor!==r.constructor)return!1;var n,a,s;if(Array.isArray(t)){if(n=t.length,n!=r.length)return!1;for(a=n;a--!==0;)if(!e(t[a],r[a]))return!1;return!0}if(t.constructor===RegExp)return t.source===r.source&&t.flags===r.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===r.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===r.toString();if(s=Object.keys(t),n=s.length,n!==Object.keys(r).length)return!1;for(a=n;a--!==0;)if(!Object.prototype.hasOwnProperty.call(r,s[a]))return!1;for(a=n;a--!==0;){var l=s[a];if(!e(t[l],r[l]))return!1}return!0}return t!==t&&r!==r},Vr={},ro={get exports(){return Vr},set exports(e){Vr=e}},Je=ro.exports=function(e,t,r){typeof t=="function"&&(r=t,t={}),r=t.cb||r;var n=typeof r=="function"?r:r.pre||function(){},a=r.post||function(){};er(t,n,a,e,"",e)};Je.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0},Je.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0},Je.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0},Je.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function er(e,t,r,n,a,s,l,f,d,u){if(n&&typeof n=="object"&&!Array.isArray(n)){t(n,a,s,l,f,d,u);for(var i in n){var p=n[i];if(Array.isArray(p)){if(i in Je.arrayKeywords)for(var b=0;b<p.length;b++)er(e,t,r,p[b],a+"/"+i+"/"+b,s,a,i,n,b)}else if(i in Je.propsKeywords){if(p&&typeof p=="object")for(var w in p)er(e,t,r,p[w],a+"/"+i+"/"+no(w),s,a,i,n,w)}else(i in Je.keywords||e.allKeys&&!(i in Je.skipKeywords))&&er(e,t,r,p,a+"/"+i,s,a,i,n)}r(n,a,s,l,f,d,u)}}function no(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(he,"__esModule",{value:!0}),he.getSchemaRefs=he.resolveUrl=he.normalizeId=he._getFullPath=he.getFullPath=he.inlineRef=void 0;const ao=ee,so=Wn,oo=Vr,io=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function co(e,t=!0){return typeof e=="boolean"?!0:t===!0?!zr(e):t?Jn(e)<=t:!1}he.inlineRef=co;const lo=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function zr(e){for(const t in e){if(lo.has(t))return!0;const r=e[t];if(Array.isArray(r)&&r.some(zr)||typeof r=="object"&&zr(r))return!0}return!1}function Jn(e){let t=0;for(const r in e){if(r==="$ref")return 1/0;if(t++,!io.has(r)&&(typeof e[r]=="object"&&(0,ao.eachItem)(e[r],n=>t+=Jn(n)),t===1/0))return 1/0}return t}function Bn(e,t="",r){r!==!1&&(t=dt(t));const n=e.parse(t);return Yn(e,n)}he.getFullPath=Bn;function Yn(e,t){return e.serialize(t).split("#")[0]+"#"}he._getFullPath=Yn;const uo=/#\/?$/;function dt(e){return e?e.replace(uo,""):""}he.normalizeId=dt;function fo(e,t,r){return r=dt(r),e.resolve(t,r)}he.resolveUrl=fo;const po=/^[a-z_][-a-z0-9._]*$/i;function mo(e,t){if(typeof e=="boolean")return{};const{schemaId:r,uriResolver:n}=this.opts,a=dt(e[r]||t),s={"":a},l=Bn(n,a,!1),f={},d=new Set;return oo(e,{allKeys:!0},(p,b,w,g)=>{if(g===void 0)return;const _=l+b;let $=s[g];typeof p[r]=="string"&&($=h.call(this,p[r])),P.call(this,p.$anchor),P.call(this,p.$dynamicAnchor),s[b]=$;function h(O){const R=this.opts.uriResolver.resolve;if(O=dt($?R($,O):O),d.has(O))throw i(O);d.add(O);let D=this.refs[O];return typeof D=="string"&&(D=this.refs[D]),typeof D=="object"?u(p,D.schema,O):O!==dt(_)&&(O[0]==="#"?(u(p,f[O],O),f[O]=p):this.refs[O]=_),O}function P(O){if(typeof O=="string"){if(!po.test(O))throw new Error(`invalid anchor "${O}"`);h.call(this,`#${O}`)}}}),f;function u(p,b,w){if(b!==void 0&&!so(p,b))throw i(w)}function i(p){return new Error(`reference "${p}" resolves to more than one schema`)}}he.getSchemaRefs=mo,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.getData=Ne.KeywordCxt=Ne.validateFunctionCode=void 0;const Xn=lt,Qn=jt,Fr=Le,tr=jt,ho=xt,Rt=Ie,Ur=We,L=J,G=Re,yo=he,qe=ee,It=Tt;function vo(e){if(ta(e)&&(ra(e),ea(e))){_o(e);return}Zn(e,()=>(0,Xn.topBoolOrEmptySchema)(e))}Ne.validateFunctionCode=vo;function Zn({gen:e,validateName:t,schema:r,schemaEnv:n,opts:a},s){a.code.es5?e.func(t,(0,L._)`${G.default.data}, ${G.default.valCxt}`,n.$async,()=>{e.code((0,L._)`"use strict"; ${xn(r,a)}`),go(e,a),e.code(s)}):e.func(t,(0,L._)`${G.default.data}, ${$o(a)}`,n.$async,()=>e.code(xn(r,a)).code(s))}function $o(e){return(0,L._)`{${G.default.instancePath}="", ${G.default.parentData}, ${G.default.parentDataProperty}, ${G.default.rootData}=${G.default.data}${e.dynamicRef?(0,L._)`, ${G.default.dynamicAnchors}={}`:L.nil}}={}`}function go(e,t){e.if(G.default.valCxt,()=>{e.var(G.default.instancePath,(0,L._)`${G.default.valCxt}.${G.default.instancePath}`),e.var(G.default.parentData,(0,L._)`${G.default.valCxt}.${G.default.parentData}`),e.var(G.default.parentDataProperty,(0,L._)`${G.default.valCxt}.${G.default.parentDataProperty}`),e.var(G.default.rootData,(0,L._)`${G.default.valCxt}.${G.default.rootData}`),t.dynamicRef&&e.var(G.default.dynamicAnchors,(0,L._)`${G.default.valCxt}.${G.default.dynamicAnchors}`)},()=>{e.var(G.default.instancePath,(0,L._)`""`),e.var(G.default.parentData,(0,L._)`undefined`),e.var(G.default.parentDataProperty,(0,L._)`undefined`),e.var(G.default.rootData,G.default.data),t.dynamicRef&&e.var(G.default.dynamicAnchors,(0,L._)`{}`)})}function _o(e){const{schema:t,opts:r,gen:n}=e;Zn(e,()=>{r.$comment&&t.$comment&&aa(e),Po(e),n.let(G.default.vErrors,null),n.let(G.default.errors,0),r.unevaluated&&wo(e),na(e),To(e)})}function wo(e){const{gen:t,validateName:r}=e;e.evaluated=t.const("evaluated",(0,L._)`${r}.evaluated`),t.if((0,L._)`${e.evaluated}.dynamicProps`,()=>t.assign((0,L._)`${e.evaluated}.props`,(0,L._)`undefined`)),t.if((0,L._)`${e.evaluated}.dynamicItems`,()=>t.assign((0,L._)`${e.evaluated}.items`,(0,L._)`undefined`))}function xn(e,t){const r=typeof e=="object"&&e[t.schemaId];return r&&(t.code.source||t.code.process)?(0,L._)`/*# sourceURL=${r} */`:L.nil}function bo(e,t){if(ta(e)&&(ra(e),ea(e))){Eo(e,t);return}(0,Xn.boolOrEmptySchema)(e,t)}function ea({schema:e,self:t}){if(typeof e=="boolean")return!e;for(const r in e)if(t.RULES.all[r])return!0;return!1}function ta(e){return typeof e.schema!="boolean"}function Eo(e,t){const{schema:r,gen:n,opts:a}=e;a.$comment&&r.$comment&&aa(e),Oo(e),No(e);const s=n.const("_errs",G.default.errors);na(e,s),n.var(t,(0,L._)`${s} === ${G.default.errors}`)}function ra(e){(0,qe.checkUnknownRules)(e),So(e)}function na(e,t){if(e.opts.jtd)return sa(e,[],!1,t);const r=(0,Qn.getSchemaTypes)(e.schema),n=(0,Qn.coerceAndCheckDataType)(e,r);sa(e,r,!n,t)}function So(e){const{schema:t,errSchemaPath:r,opts:n,self:a}=e;t.$ref&&n.ignoreKeywordsWithRef&&(0,qe.schemaHasRulesButRef)(t,a.RULES)&&a.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function Po(e){const{schema:t,opts:r}=e;t.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,qe.checkStrictMode)(e,"default is ignored in the schema root")}function Oo(e){const t=e.schema[e.opts.schemaId];t&&(e.baseId=(0,yo.resolveUrl)(e.opts.uriResolver,e.baseId,t))}function No(e){if(e.schema.$async&&!e.schemaEnv.$async)throw new Error("async schema in sync schema")}function aa({gen:e,schemaEnv:t,schema:r,errSchemaPath:n,opts:a}){const s=r.$comment;if(a.$comment===!0)e.code((0,L._)`${G.default.self}.logger.log(${s})`);else if(typeof a.$comment=="function"){const l=(0,L.str)`${n}/$comment`,f=e.scopeValue("root",{ref:t.root});e.code((0,L._)`${G.default.self}.opts.$comment(${s}, ${l}, ${f}.schema)`)}}function To(e){const{gen:t,schemaEnv:r,validateName:n,ValidationError:a,opts:s}=e;r.$async?t.if((0,L._)`${G.default.errors} === 0`,()=>t.return(G.default.data),()=>t.throw((0,L._)`new ${a}(${G.default.vErrors})`)):(t.assign((0,L._)`${n}.errors`,G.default.vErrors),s.unevaluated&&Co(e),t.return((0,L._)`${G.default.errors} === 0`))}function Co({gen:e,evaluated:t,props:r,items:n}){r instanceof L.Name&&e.assign((0,L._)`${t}.props`,r),n instanceof L.Name&&e.assign((0,L._)`${t}.items`,n)}function sa(e,t,r,n){const{gen:a,schema:s,data:l,allErrors:f,opts:d,self:u}=e,{RULES:i}=u;if(s.$ref&&(d.ignoreKeywordsWithRef||!(0,qe.schemaHasRulesButRef)(s,i))){a.block(()=>la(e,"$ref",i.all.$ref.definition));return}d.jtd||jo(e,t),a.block(()=>{for(const b of i.rules)p(b);p(i.post)});function p(b){(0,Fr.shouldUseGroup)(s,b)&&(b.type?(a.if((0,tr.checkDataType)(b.type,l,d.strictNumbers)),oa(e,b),t.length===1&&t[0]===b.type&&r&&(a.else(),(0,tr.reportTypeError)(e)),a.endIf()):oa(e,b),f||a.if((0,L._)`${G.default.errors} === ${n||0}`))}}function oa(e,t){const{gen:r,schema:n,opts:{useDefaults:a}}=e;a&&(0,ho.assignDefaults)(e,t.type),r.block(()=>{for(const s of t.rules)(0,Fr.shouldUseRule)(n,s)&&la(e,s.keyword,s.definition,t.type)})}function jo(e,t){e.schemaEnv.meta||!e.opts.strictTypes||(Ro(e,t),e.opts.allowUnionTypes||Io(e,t),ko(e,e.dataTypes))}function Ro(e,t){if(t.length){if(!e.dataTypes.length){e.dataTypes=t;return}t.forEach(r=>{ia(e.dataTypes,r)||Lr(e,`type "${r}" not allowed by context "${e.dataTypes.join(",")}"`)}),Ao(e,t)}}function Io(e,t){t.length>1&&!(t.length===2&&t.includes("null"))&&Lr(e,"use allowUnionTypes to allow union type keyword")}function ko(e,t){const r=e.self.RULES.all;for(const n in r){const a=r[n];if(typeof a=="object"&&(0,Fr.shouldUseRule)(e.schema,a)){const{type:s}=a.definition;s.length&&!s.some(l=>Do(t,l))&&Lr(e,`missing type "${s.join(",")}" for keyword "${n}"`)}}}function Do(e,t){return e.includes(t)||t==="number"&&e.includes("integer")}function ia(e,t){return e.includes(t)||t==="integer"&&e.includes("number")}function Ao(e,t){const r=[];for(const n of e.dataTypes)ia(t,n)?r.push(n):t.includes("integer")&&n==="number"&&r.push("integer");e.dataTypes=r}function Lr(e,t){const r=e.schemaEnv.baseId+e.errSchemaPath;t+=` at "${r}" (strictTypes)`,(0,qe.checkStrictMode)(e,t,e.opts.strictTypes)}class ca{constructor(t,r,n){if((0,Rt.validateKeywordUsage)(t,r,n),this.gen=t.gen,this.allErrors=t.allErrors,this.keyword=n,this.data=t.data,this.schema=t.schema[n],this.$data=r.$data&&t.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,qe.schemaRefOrVal)(t,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=t.schema,this.params={},this.it=t,this.def=r,this.$data)this.schemaCode=t.gen.const("vSchema",ua(this.$data,t));else if(this.schemaCode=this.schemaValue,!(0,Rt.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=t.gen.const("_errs",G.default.errors))}result(t,r,n){this.failResult((0,L.not)(t),r,n)}failResult(t,r,n){this.gen.if(t),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(t,r){this.failResult((0,L.not)(t),void 0,r)}fail(t){if(t===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(t),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(t){if(!this.$data)return this.fail(t);const{schemaCode:r}=this;this.fail((0,L._)`${r} !== undefined && (${(0,L.or)(this.invalid$data(),t)})`)}error(t,r,n){if(r){this.setParams(r),this._error(t,n),this.setParams({});return}this._error(t,n)}_error(t,r){(t?It.reportExtraError:It.reportError)(this,this.def.error,r)}$dataError(){(0,It.reportError)(this,this.def.$dataError||It.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,It.resetErrorsCount)(this.gen,this.errsCount)}ok(t){this.allErrors||this.gen.if(t)}setParams(t,r){r?Object.assign(this.params,t):this.params=t}block$data(t,r,n=L.nil){this.gen.block(()=>{this.check$data(t,n),r()})}check$data(t=L.nil,r=L.nil){if(!this.$data)return;const{gen:n,schemaCode:a,schemaType:s,def:l}=this;n.if((0,L.or)((0,L._)`${a} === undefined`,r)),t!==L.nil&&n.assign(t,!0),(s.length||l.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),t!==L.nil&&n.assign(t,!1)),n.else()}invalid$data(){const{gen:t,schemaCode:r,schemaType:n,def:a,it:s}=this;return(0,L.or)(l(),f());function l(){if(n.length){if(!(r instanceof L.Name))throw new Error("ajv implementation error");const d=Array.isArray(n)?n:[n];return(0,L._)`${(0,tr.checkDataTypes)(d,r,s.opts.strictNumbers,tr.DataType.Wrong)}`}return L.nil}function f(){if(a.validateSchema){const d=t.scopeValue("validate$data",{ref:a.validateSchema});return(0,L._)`!${d}(${r})`}return L.nil}}subschema(t,r){const n=(0,Ur.getSubschema)(this.it,t);(0,Ur.extendSubschemaData)(n,this.it,t),(0,Ur.extendSubschemaMode)(n,t);const a={...this.it,...n,items:void 0,props:void 0};return bo(a,r),a}mergeEvaluated(t,r){const{it:n,gen:a}=this;n.opts.unevaluated&&(n.props!==!0&&t.props!==void 0&&(n.props=qe.mergeEvaluated.props(a,t.props,n.props,r)),n.items!==!0&&t.items!==void 0&&(n.items=qe.mergeEvaluated.items(a,t.items,n.items,r)))}mergeValidEvaluated(t,r){const{it:n,gen:a}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return a.if(r,()=>this.mergeEvaluated(t,L.Name)),!0}}Ne.KeywordCxt=ca;function la(e,t,r,n){const a=new ca(e,r,t);"code"in r?r.code(a,n):a.$data&&r.validate?(0,Rt.funcKeywordCode)(a,r):"macro"in r?(0,Rt.macroKeywordCode)(a,r):(r.compile||r.validate)&&(0,Rt.funcKeywordCode)(a,r)}const Mo=/^\/(?:[^~]|~0|~1)*$/,Vo=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function ua(e,{dataLevel:t,dataNames:r,dataPathArr:n}){let a,s;if(e==="")return G.default.rootData;if(e[0]==="/"){if(!Mo.test(e))throw new Error(`Invalid JSON-pointer: ${e}`);a=e,s=G.default.rootData}else{const u=Vo.exec(e);if(!u)throw new Error(`Invalid JSON-pointer: ${e}`);const i=+u[1];if(a=u[2],a==="#"){if(i>=t)throw new Error(d("property/index",i));return n[t-i]}if(i>t)throw new Error(d("data",i));if(s=r[t-i],!a)return s}let l=s;const f=a.split("/");for(const u of f)u&&(s=(0,L._)`${s}${(0,L.getProperty)((0,qe.unescapeJsonPointer)(u))}`,l=(0,L._)`${l} && ${s}`);return l;function d(u,i){return`Cannot access ${u} ${i} levels up, current level is ${t}`}}Ne.getData=ua;var kt={};Object.defineProperty(kt,"__esModule",{value:!0});class zo extends Error{constructor(t){super("validation failed"),this.errors=t,this.ajv=this.validation=!0}}kt.default=zo;var Dt={};Object.defineProperty(Dt,"__esModule",{value:!0});const qr=he;class Fo extends Error{constructor(t,r,n,a){super(a||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,qr.resolveUrl)(t,r,n),this.missingSchema=(0,qr.normalizeId)((0,qr.getFullPath)(t,this.missingRef))}}Dt.default=Fo;var ge={};Object.defineProperty(ge,"__esModule",{value:!0}),ge.resolveSchema=ge.getCompilingSchema=ge.resolveRef=ge.compileSchema=ge.SchemaEnv=void 0;const Te=J,Uo=kt,et=Re,Ce=he,da=ee,Lo=Ne;class rr{constructor(t){var r;this.refs={},this.dynamicAnchors={};let n;typeof t.schema=="object"&&(n=t.schema),this.schema=t.schema,this.schemaId=t.schemaId,this.root=t.root||this,this.baseId=(r=t.baseId)!==null&&r!==void 0?r:(0,Ce.normalizeId)(n==null?void 0:n[t.schemaId||"$id"]),this.schemaPath=t.schemaPath,this.localRefs=t.localRefs,this.meta=t.meta,this.$async=n==null?void 0:n.$async,this.refs={}}}ge.SchemaEnv=rr;function Kr(e){const t=fa.call(this,e);if(t)return t;const r=(0,Ce.getFullPath)(this.opts.uriResolver,e.root.baseId),{es5:n,lines:a}=this.opts.code,{ownProperties:s}=this.opts,l=new Te.CodeGen(this.scope,{es5:n,lines:a,ownProperties:s});let f;e.$async&&(f=l.scopeValue("Error",{ref:Uo.default,code:(0,Te._)`require("ajv/dist/runtime/validation_error").default`}));const d=l.scopeName("validate");e.validateName=d;const u={gen:l,allErrors:this.opts.allErrors,data:et.default.data,parentData:et.default.parentData,parentDataProperty:et.default.parentDataProperty,dataNames:[et.default.data],dataPathArr:[Te.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:l.scopeValue("schema",this.opts.code.source===!0?{ref:e.schema,code:(0,Te.stringify)(e.schema)}:{ref:e.schema}),validateName:d,ValidationError:f,schema:e.schema,schemaEnv:e,rootId:r,baseId:e.baseId||r,schemaPath:Te.nil,errSchemaPath:e.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,Te._)`""`,opts:this.opts,self:this};let i;try{this._compilations.add(e),(0,Lo.validateFunctionCode)(u),l.optimize(this.opts.code.optimize);const p=l.toString();i=`${l.scopeRefs(et.default.scope)}return ${p}`,this.opts.code.process&&(i=this.opts.code.process(i,e));const w=new Function(`${et.default.self}`,`${et.default.scope}`,i)(this,this.scope.get());if(this.scope.value(d,{ref:w}),w.errors=null,w.schema=e.schema,w.schemaEnv=e,e.$async&&(w.$async=!0),this.opts.code.source===!0&&(w.source={validateName:d,validateCode:p,scopeValues:l._values}),this.opts.unevaluated){const{props:g,items:_}=u;w.evaluated={props:g instanceof Te.Name?void 0:g,items:_ instanceof Te.Name?void 0:_,dynamicProps:g instanceof Te.Name,dynamicItems:_ instanceof Te.Name},w.source&&(w.source.evaluated=(0,Te.stringify)(w.evaluated))}return e.validate=w,e}catch(p){throw delete e.validate,delete e.validateName,i&&this.logger.error("Error compiling schema, function code:",i),p}finally{this._compilations.delete(e)}}ge.compileSchema=Kr;function qo(e,t,r){var n;r=(0,Ce.resolveUrl)(this.opts.uriResolver,t,r);const a=e.refs[r];if(a)return a;let s=Go.call(this,e,r);if(s===void 0){const l=(n=e.localRefs)===null||n===void 0?void 0:n[r],{schemaId:f}=this.opts;l&&(s=new rr({schema:l,schemaId:f,root:e,baseId:t}))}if(s!==void 0)return e.refs[r]=Ko.call(this,s)}ge.resolveRef=qo;function Ko(e){return(0,Ce.inlineRef)(e.schema,this.opts.inlineRefs)?e.schema:e.validate?e:Kr.call(this,e)}function fa(e){for(const t of this._compilations)if(Ho(t,e))return t}ge.getCompilingSchema=fa;function Ho(e,t){return e.schema===t.schema&&e.root===t.root&&e.baseId===t.baseId}function Go(e,t){let r;for(;typeof(r=this.refs[t])=="string";)t=r;return r||this.schemas[t]||nr.call(this,e,t)}function nr(e,t){const r=this.opts.uriResolver.parse(t),n=(0,Ce._getFullPath)(this.opts.uriResolver,r);let a=(0,Ce.getFullPath)(this.opts.uriResolver,e.baseId,void 0);if(Object.keys(e.schema).length>0&&n===a)return Hr.call(this,r,e);const s=(0,Ce.normalizeId)(n),l=this.refs[s]||this.schemas[s];if(typeof l=="string"){const f=nr.call(this,e,l);return typeof(f==null?void 0:f.schema)!="object"?void 0:Hr.call(this,r,f)}if(typeof(l==null?void 0:l.schema)=="object"){if(l.validate||Kr.call(this,l),s===(0,Ce.normalizeId)(t)){const{schema:f}=l,{schemaId:d}=this.opts,u=f[d];return u&&(a=(0,Ce.resolveUrl)(this.opts.uriResolver,a,u)),new rr({schema:f,schemaId:d,root:e,baseId:a})}return Hr.call(this,r,l)}}ge.resolveSchema=nr;const Wo=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function Hr(e,{baseId:t,schema:r,root:n}){var a;if(((a=e.fragment)===null||a===void 0?void 0:a[0])!=="/")return;for(const f of e.fragment.slice(1).split("/")){if(typeof r=="boolean")return;const d=r[(0,da.unescapeFragment)(f)];if(d===void 0)return;r=d;const u=typeof r=="object"&&r[this.opts.schemaId];!Wo.has(f)&&u&&(t=(0,Ce.resolveUrl)(this.opts.uriResolver,t,u))}let s;if(typeof r!="boolean"&&r.$ref&&!(0,da.schemaHasRulesButRef)(r,this.RULES)){const f=(0,Ce.resolveUrl)(this.opts.uriResolver,t,r.$ref);s=nr.call(this,n,f)}const{schemaId:l}=this.opts;if(s=s||new rr({schema:r,schemaId:l,root:n,baseId:t}),s.schema!==s.root.schema)return s}const Jo={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1};var Gr={},ar={},Bo={get exports(){return ar},set exports(e){ar=e}};/** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js */(function(e,t){(function(r,n){n(t)})($s,function(r){function n(){for(var m=arguments.length,c=Array(m),v=0;v<m;v++)c[v]=arguments[v];if(c.length>1){c[0]=c[0].slice(0,-1);for(var C=c.length-1,T=1;T<C;++T)c[T]=c[T].slice(1,-1);return c[C]=c[C].slice(1),c.join("")}else return c[0]}function a(m){return"(?:"+m+")"}function s(m){return m===void 0?"undefined":m===null?"null":Object.prototype.toString.call(m).split(" ").pop().split("]").shift().toLowerCase()}function l(m){return m.toUpperCase()}function f(m){return m!=null?m instanceof Array?m:typeof m.length!="number"||m.split||m.setInterval||m.call?[m]:Array.prototype.slice.call(m):[]}function d(m,c){var v=m;if(c)for(var C in c)v[C]=c[C];return v}function u(m){var c="[A-Za-z]",v="[0-9]",C=n(v,"[A-Fa-f]"),T=a(a("%[EFef]"+C+"%"+C+C+"%"+C+C)+"|"+a("%[89A-Fa-f]"+C+"%"+C+C)+"|"+a("%"+C+C)),q="[\\:\\/\\?\\#\\[\\]\\@]",K="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",x=n(q,K),ae=m?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",le=m?"[\\uE000-\\uF8FF]":"[]",Q=n(c,v,"[\\-\\.\\_\\~]",ae);a(c+n(c,v,"[\\+\\-\\.]")+"*"),a(a(T+"|"+n(Q,K,"[\\:]"))+"*");var te=a(a("25[0-5]")+"|"+a("2[0-4]"+v)+"|"+a("1"+v+v)+"|"+a("0?[1-9]"+v)+"|0?0?"+v),ue=a(te+"\\."+te+"\\."+te+"\\."+te),W=a(C+"{1,4}"),se=a(a(W+"\\:"+W)+"|"+ue),fe=a(a(W+"\\:")+"{6}"+se),oe=a("\\:\\:"+a(W+"\\:")+"{5}"+se),Xe=a(a(W)+"?\\:\\:"+a(W+"\\:")+"{4}"+se),ze=a(a(a(W+"\\:")+"{0,1}"+W)+"?\\:\\:"+a(W+"\\:")+"{3}"+se),Fe=a(a(a(W+"\\:")+"{0,2}"+W)+"?\\:\\:"+a(W+"\\:")+"{2}"+se),Ot=a(a(a(W+"\\:")+"{0,3}"+W)+"?\\:\\:"+W+"\\:"+se),it=a(a(a(W+"\\:")+"{0,4}"+W)+"?\\:\\:"+se),Oe=a(a(a(W+"\\:")+"{0,5}"+W)+"?\\:\\:"+W),Ue=a(a(a(W+"\\:")+"{0,6}"+W)+"?\\:\\:"),ct=a([fe,oe,Xe,ze,Fe,Ot,it,Oe,Ue].join("|")),He=a(a(Q+"|"+T)+"+");a("[vV]"+C+"+\\."+n(Q,K,"[\\:]")+"+"),a(a(T+"|"+n(Q,K))+"*");var Qt=a(T+"|"+n(Q,K,"[\\:\\@]"));return a(a(T+"|"+n(Q,K,"[\\@]"))+"+"),a(a(Qt+"|"+n("[\\/\\?]",le))+"*"),{NOT_SCHEME:new RegExp(n("[^]",c,v,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(n("[^\\%\\:]",Q,K),"g"),NOT_HOST:new RegExp(n("[^\\%\\[\\]\\:]",Q,K),"g"),NOT_PATH:new RegExp(n("[^\\%\\/\\:\\@]",Q,K),"g"),NOT_PATH_NOSCHEME:new RegExp(n("[^\\%\\/\\@]",Q,K),"g"),NOT_QUERY:new RegExp(n("[^\\%]",Q,K,"[\\:\\@\\/\\?]",le),"g"),NOT_FRAGMENT:new RegExp(n("[^\\%]",Q,K,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(n("[^]",Q,K),"g"),UNRESERVED:new RegExp(Q,"g"),OTHER_CHARS:new RegExp(n("[^\\%]",Q,x),"g"),PCT_ENCODED:new RegExp(T,"g"),IPV4ADDRESS:new RegExp("^("+ue+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ct+")"+a(a("\\%25|\\%(?!"+C+"{2})")+"("+He+")")+"?\\]?$")}}var i=u(!1),p=u(!0),b=function(){function m(c,v){var C=[],T=!0,q=!1,K=void 0;try{for(var x=c[Symbol.iterator](),ae;!(T=(ae=x.next()).done)&&(C.push(ae.value),!(v&&C.length===v));T=!0);}catch(le){q=!0,K=le}finally{try{!T&&x.return&&x.return()}finally{if(q)throw K}}return C}return function(c,v){if(Array.isArray(c))return c;if(Symbol.iterator in Object(c))return m(c,v);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),w=function(m){if(Array.isArray(m)){for(var c=0,v=Array(m.length);c<m.length;c++)v[c]=m[c];return v}else return Array.from(m)},g=2147483647,_=36,$=1,h=26,P=38,O=700,R=72,D=128,E="-",j=/^xn--/,A=/[^\0-\x7E]/,M=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},B=_-$,H=Math.floor,de=String.fromCharCode;function ne(m){throw new RangeError(U[m])}function Se(m,c){for(var v=[],C=m.length;C--;)v[C]=c(m[C]);return v}function at(m,c){var v=m.split("@"),C="";v.length>1&&(C=v[0]+"@",m=v[1]),m=m.replace(M,".");var T=m.split("."),q=Se(T,c).join(".");return C+q}function $t(m){for(var c=[],v=0,C=m.length;v<C;){var T=m.charCodeAt(v++);if(T>=55296&&T<=56319&&v<C){var q=m.charCodeAt(v++);(q&64512)==56320?c.push(((T&1023)<<10)+(q&1023)+65536):(c.push(T),v--)}else c.push(T)}return c}var Kt=function(c){return String.fromCodePoint.apply(String,w(c))},gt=function(c){return c-48<10?c-22:c-65<26?c-65:c-97<26?c-97:_},V=function(c,v){return c+22+75*(c<26)-((v!=0)<<5)},S=function(c,v,C){var T=0;for(c=C?H(c/O):c>>1,c+=H(c/v);c>B*h>>1;T+=_)c=H(c/B);return H(T+(B+1)*c/(c+P))},k=function(c){var v=[],C=c.length,T=0,q=D,K=R,x=c.lastIndexOf(E);x<0&&(x=0);for(var ae=0;ae<x;++ae)c.charCodeAt(ae)>=128&&ne("not-basic"),v.push(c.charCodeAt(ae));for(var le=x>0?x+1:0;le<C;){for(var Q=T,te=1,ue=_;;ue+=_){le>=C&&ne("invalid-input");var W=gt(c.charCodeAt(le++));(W>=_||W>H((g-T)/te))&&ne("overflow"),T+=W*te;var se=ue<=K?$:ue>=K+h?h:ue-K;if(W<se)break;var fe=_-se;te>H(g/fe)&&ne("overflow"),te*=fe}var oe=v.length+1;K=S(T-Q,oe,Q==0),H(T/oe)>g-q&&ne("overflow"),q+=H(T/oe),T%=oe,v.splice(T++,0,q)}return String.fromCodePoint.apply(String,v)},N=function(c){var v=[];c=$t(c);var C=c.length,T=D,q=0,K=R,x=!0,ae=!1,le=void 0;try{for(var Q=c[Symbol.iterator](),te;!(x=(te=Q.next()).done);x=!0){var ue=te.value;ue<128&&v.push(de(ue))}}catch(Zt){ae=!0,le=Zt}finally{try{!x&&Q.return&&Q.return()}finally{if(ae)throw le}}var W=v.length,se=W;for(W&&v.push(E);se<C;){var fe=g,oe=!0,Xe=!1,ze=void 0;try{for(var Fe=c[Symbol.iterator](),Ot;!(oe=(Ot=Fe.next()).done);oe=!0){var it=Ot.value;it>=T&&it<fe&&(fe=it)}}catch(Zt){Xe=!0,ze=Zt}finally{try{!oe&&Fe.return&&Fe.return()}finally{if(Xe)throw ze}}var Oe=se+1;fe-T>H((g-q)/Oe)&&ne("overflow"),q+=(fe-T)*Oe,T=fe;var Ue=!0,ct=!1,He=void 0;try{for(var Qt=c[Symbol.iterator](),as;!(Ue=(as=Qt.next()).done);Ue=!0){var ss=as.value;if(ss<T&&++q>g&&ne("overflow"),ss==T){for(var Nr=q,Tr=_;;Tr+=_){var Cr=Tr<=K?$:Tr>=K+h?h:Tr-K;if(Nr<Cr)break;var os=Nr-Cr,is=_-Cr;v.push(de(V(Cr+os%is,0))),Nr=H(os/is)}v.push(de(V(Nr,0))),K=S(q,Oe,se==W),q=0,++se}}}catch(Zt){ct=!0,He=Zt}finally{try{!Ue&&Qt.return&&Qt.return()}finally{if(ct)throw He}}++q,++T}return v.join("")},o=function(c){return at(c,function(v){return j.test(v)?k(v.slice(4).toLowerCase()):v})},y=function(c){return at(c,function(v){return A.test(v)?"xn--"+N(v):v})},I={version:"2.1.0",ucs2:{decode:$t,encode:Kt},decode:k,encode:N,toASCII:y,toUnicode:o},z={};function F(m){var c=m.charCodeAt(0),v=void 0;return c<16?v="%0"+c.toString(16).toUpperCase():c<128?v="%"+c.toString(16).toUpperCase():c<2048?v="%"+(c>>6|192).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase():v="%"+(c>>12|224).toString(16).toUpperCase()+"%"+(c>>6&63|128).toString(16).toUpperCase()+"%"+(c&63|128).toString(16).toUpperCase(),v}function X(m){for(var c="",v=0,C=m.length;v<C;){var T=parseInt(m.substr(v+1,2),16);if(T<128)c+=String.fromCharCode(T),v+=3;else if(T>=194&&T<224){if(C-v>=6){var q=parseInt(m.substr(v+4,2),16);c+=String.fromCharCode((T&31)<<6|q&63)}else c+=m.substr(v,6);v+=6}else if(T>=224){if(C-v>=9){var K=parseInt(m.substr(v+4,2),16),x=parseInt(m.substr(v+7,2),16);c+=String.fromCharCode((T&15)<<12|(K&63)<<6|x&63)}else c+=m.substr(v,9);v+=9}else c+=m.substr(v,3),v+=3}return c}function Z(m,c){function v(C){var T=X(C);return T.match(c.UNRESERVED)?T:C}return m.scheme&&(m.scheme=String(m.scheme).replace(c.PCT_ENCODED,v).toLowerCase().replace(c.NOT_SCHEME,"")),m.userinfo!==void 0&&(m.userinfo=String(m.userinfo).replace(c.PCT_ENCODED,v).replace(c.NOT_USERINFO,F).replace(c.PCT_ENCODED,l)),m.host!==void 0&&(m.host=String(m.host).replace(c.PCT_ENCODED,v).toLowerCase().replace(c.NOT_HOST,F).replace(c.PCT_ENCODED,l)),m.path!==void 0&&(m.path=String(m.path).replace(c.PCT_ENCODED,v).replace(m.scheme?c.NOT_PATH:c.NOT_PATH_NOSCHEME,F).replace(c.PCT_ENCODED,l)),m.query!==void 0&&(m.query=String(m.query).replace(c.PCT_ENCODED,v).replace(c.NOT_QUERY,F).replace(c.PCT_ENCODED,l)),m.fragment!==void 0&&(m.fragment=String(m.fragment).replace(c.PCT_ENCODED,v).replace(c.NOT_FRAGMENT,F).replace(c.PCT_ENCODED,l)),m}function ie(m){return m.replace(/^0*(.*)/,"$1")||"0"}function Ae(m,c){var v=m.match(c.IPV4ADDRESS)||[],C=b(v,2),T=C[1];return T?T.split(".").map(ie).join("."):m}function _t(m,c){var v=m.match(c.IPV6ADDRESS)||[],C=b(v,3),T=C[1],q=C[2];if(T){for(var K=T.toLowerCase().split("::").reverse(),x=b(K,2),ae=x[0],le=x[1],Q=le?le.split(":").map(ie):[],te=ae.split(":").map(ie),ue=c.IPV4ADDRESS.test(te[te.length-1]),W=ue?7:8,se=te.length-W,fe=Array(W),oe=0;oe<W;++oe)fe[oe]=Q[oe]||te[se+oe]||"";ue&&(fe[W-1]=Ae(fe[W-1],c));var Xe=fe.reduce(function(Oe,Ue,ct){if(!Ue||Ue==="0"){var He=Oe[Oe.length-1];He&&He.index+He.length===ct?He.length++:Oe.push({index:ct,length:1})}return Oe},[]),ze=Xe.sort(function(Oe,Ue){return Ue.length-Oe.length})[0],Fe=void 0;if(ze&&ze.length>1){var Ot=fe.slice(0,ze.index),it=fe.slice(ze.index+ze.length);Fe=Ot.join(":")+"::"+it.join(":")}else Fe=fe.join(":");return q&&(Fe+="%"+q),Fe}else return m}var Ht=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Gt="".match(/(){0}/)[1]===void 0;function be(m){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v={},C=c.iri!==!1?p:i;c.reference==="suffix"&&(m=(c.scheme?c.scheme+":":"")+"//"+m);var T=m.match(Ht);if(T){Gt?(v.scheme=T[1],v.userinfo=T[3],v.host=T[4],v.port=parseInt(T[5],10),v.path=T[6]||"",v.query=T[7],v.fragment=T[8],isNaN(v.port)&&(v.port=T[5])):(v.scheme=T[1]||void 0,v.userinfo=m.indexOf("@")!==-1?T[3]:void 0,v.host=m.indexOf("//")!==-1?T[4]:void 0,v.port=parseInt(T[5],10),v.path=T[6]||"",v.query=m.indexOf("?")!==-1?T[7]:void 0,v.fragment=m.indexOf("#")!==-1?T[8]:void 0,isNaN(v.port)&&(v.port=m.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?T[4]:void 0)),v.host&&(v.host=_t(Ae(v.host,C),C)),v.scheme===void 0&&v.userinfo===void 0&&v.host===void 0&&v.port===void 0&&!v.path&&v.query===void 0?v.reference="same-document":v.scheme===void 0?v.reference="relative":v.fragment===void 0?v.reference="absolute":v.reference="uri",c.reference&&c.reference!=="suffix"&&c.reference!==v.reference&&(v.error=v.error||"URI is not a "+c.reference+" reference.");var q=z[(c.scheme||v.scheme||"").toLowerCase()];if(!c.unicodeSupport&&(!q||!q.unicodeSupport)){if(v.host&&(c.domainHost||q&&q.domainHost))try{v.host=I.toASCII(v.host.replace(C.PCT_ENCODED,X).toLowerCase())}catch(K){v.error=v.error||"Host's domain name can not be converted to ASCII via punycode: "+K}Z(v,i)}else Z(v,C);q&&q.parse&&q.parse(v,c)}else v.error=v.error||"URI can not be parsed.";return v}function Wt(m,c){var v=c.iri!==!1?p:i,C=[];return m.userinfo!==void 0&&(C.push(m.userinfo),C.push("@")),m.host!==void 0&&C.push(_t(Ae(String(m.host),v),v).replace(v.IPV6ADDRESS,function(T,q,K){return"["+q+(K?"%25"+K:"")+"]"})),(typeof m.port=="number"||typeof m.port=="string")&&(C.push(":"),C.push(String(m.port))),C.length?C.join(""):void 0}var wt=/^\.\.?\//,bt=/^\/\.(\/|$)/,Et=/^\/\.\.(\/|$)/,Jt=/^\/?(?:.|\n)*?(?=\/|$)/;function Me(m){for(var c=[];m.length;)if(m.match(wt))m=m.replace(wt,"");else if(m.match(bt))m=m.replace(bt,"/");else if(m.match(Et))m=m.replace(Et,"/"),c.pop();else if(m==="."||m==="..")m="";else{var v=m.match(Jt);if(v){var C=v[0];m=m.slice(C.length),c.push(C)}else throw new Error("Unexpected dot segment condition")}return c.join("")}function we(m){var c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},v=c.iri?p:i,C=[],T=z[(c.scheme||m.scheme||"").toLowerCase()];if(T&&T.serialize&&T.serialize(m,c),m.host&&!v.IPV6ADDRESS.test(m.host)){if(c.domainHost||T&&T.domainHost)try{m.host=c.iri?I.toUnicode(m.host):I.toASCII(m.host.replace(v.PCT_ENCODED,X).toLowerCase())}catch(x){m.error=m.error||"Host's domain name can not be converted to "+(c.iri?"Unicode":"ASCII")+" via punycode: "+x}}Z(m,v),c.reference!=="suffix"&&m.scheme&&(C.push(m.scheme),C.push(":"));var q=Wt(m,c);if(q!==void 0&&(c.reference!=="suffix"&&C.push("//"),C.push(q),m.path&&m.path.charAt(0)!=="/"&&C.push("/")),m.path!==void 0){var K=m.path;!c.absolutePath&&(!T||!T.absolutePath)&&(K=Me(K)),q===void 0&&(K=K.replace(/^\/\//,"/%2F")),C.push(K)}return m.query!==void 0&&(C.push("?"),C.push(m.query)),m.fragment!==void 0&&(C.push("#"),C.push(m.fragment)),C.join("")}function St(m,c){var v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},C=arguments[3],T={};return C||(m=be(we(m,v),v),c=be(we(c,v),v)),v=v||{},!v.tolerant&&c.scheme?(T.scheme=c.scheme,T.userinfo=c.userinfo,T.host=c.host,T.port=c.port,T.path=Me(c.path||""),T.query=c.query):(c.userinfo!==void 0||c.host!==void 0||c.port!==void 0?(T.userinfo=c.userinfo,T.host=c.host,T.port=c.port,T.path=Me(c.path||""),T.query=c.query):(c.path?(c.path.charAt(0)==="/"?T.path=Me(c.path):((m.userinfo!==void 0||m.host!==void 0||m.port!==void 0)&&!m.path?T.path="/"+c.path:m.path?T.path=m.path.slice(0,m.path.lastIndexOf("/")+1)+c.path:T.path=c.path,T.path=Me(T.path)),T.query=c.query):(T.path=m.path,c.query!==void 0?T.query=c.query:T.query=m.query),T.userinfo=m.userinfo,T.host=m.host,T.port=m.port),T.scheme=m.scheme),T.fragment=c.fragment,T}function Bt(m,c,v){var C=d({scheme:"null"},v);return we(St(be(m,C),be(c,C),C,!0),C)}function st(m,c){return typeof m=="string"?m=we(be(m,c),c):s(m)==="object"&&(m=be(we(m,c),c)),m}function Yt(m,c,v){return typeof m=="string"?m=we(be(m,v),v):s(m)==="object"&&(m=we(m,v)),typeof c=="string"?c=we(be(c,v),v):s(c)==="object"&&(c=we(c,v)),m===c}function Or(m,c){return m&&m.toString().replace(!c||!c.iri?i.ESCAPE:p.ESCAPE,F)}function Pe(m,c){return m&&m.toString().replace(!c||!c.iri?i.PCT_ENCODED:p.PCT_ENCODED,X)}var ot={scheme:"http",domainHost:!0,parse:function(c,v){return c.host||(c.error=c.error||"HTTP URIs must have a host."),c},serialize:function(c,v){var C=String(c.scheme).toLowerCase()==="https";return(c.port===(C?443:80)||c.port==="")&&(c.port=void 0),c.path||(c.path="/"),c}},Xa={scheme:"https",domainHost:ot.domainHost,parse:ot.parse,serialize:ot.serialize};function Qa(m){return typeof m.secure=="boolean"?m.secure:String(m.scheme).toLowerCase()==="wss"}var Xt={scheme:"ws",domainHost:!0,parse:function(c,v){var C=c;return C.secure=Qa(C),C.resourceName=(C.path||"/")+(C.query?"?"+C.query:""),C.path=void 0,C.query=void 0,C},serialize:function(c,v){if((c.port===(Qa(c)?443:80)||c.port==="")&&(c.port=void 0),typeof c.secure=="boolean"&&(c.scheme=c.secure?"wss":"ws",c.secure=void 0),c.resourceName){var C=c.resourceName.split("?"),T=b(C,2),q=T[0],K=T[1];c.path=q&&q!=="/"?q:void 0,c.query=K,c.resourceName=void 0}return c.fragment=void 0,c}},Za={scheme:"wss",domainHost:Xt.domainHost,parse:Xt.parse,serialize:Xt.serialize},Bc={},xa="[A-Za-z0-9\\-\\.\\_\\~\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]",Ve="[0-9A-Fa-f]",Yc=a(a("%[EFef]"+Ve+"%"+Ve+Ve+"%"+Ve+Ve)+"|"+a("%[89A-Fa-f]"+Ve+"%"+Ve+Ve)+"|"+a("%"+Ve+Ve)),Xc="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",Qc="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",Zc=n(Qc,'[\\"\\\\]'),xc="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",el=new RegExp(xa,"g"),Pt=new RegExp(Yc,"g"),tl=new RegExp(n("[^]",Xc,"[\\.]",'[\\"]',Zc),"g"),es=new RegExp(n("[^]",xa,xc),"g"),rl=es;function Rn(m){var c=X(m);return c.match(el)?c:m}var ts={scheme:"mailto",parse:function(c,v){var C=c,T=C.to=C.path?C.path.split(","):[];if(C.path=void 0,C.query){for(var q=!1,K={},x=C.query.split("&"),ae=0,le=x.length;ae<le;++ae){var Q=x[ae].split("=");switch(Q[0]){case"to":for(var te=Q[1].split(","),ue=0,W=te.length;ue<W;++ue)T.push(te[ue]);break;case"subject":C.subject=Pe(Q[1],v);break;case"body":C.body=Pe(Q[1],v);break;default:q=!0,K[Pe(Q[0],v)]=Pe(Q[1],v);break}}q&&(C.headers=K)}C.query=void 0;for(var se=0,fe=T.length;se<fe;++se){var oe=T[se].split("@");if(oe[0]=Pe(oe[0]),v.unicodeSupport)oe[1]=Pe(oe[1],v).toLowerCase();else try{oe[1]=I.toASCII(Pe(oe[1],v).toLowerCase())}catch(Xe){C.error=C.error||"Email address's domain name can not be converted to ASCII via punycode: "+Xe}T[se]=oe.join("@")}return C},serialize:function(c,v){var C=c,T=f(c.to);if(T){for(var q=0,K=T.length;q<K;++q){var x=String(T[q]),ae=x.lastIndexOf("@"),le=x.slice(0,ae).replace(Pt,Rn).replace(Pt,l).replace(tl,F),Q=x.slice(ae+1);try{Q=v.iri?I.toUnicode(Q):I.toASCII(Pe(Q,v).toLowerCase())}catch(se){C.error=C.error||"Email address's domain name can not be converted to "+(v.iri?"Unicode":"ASCII")+" via punycode: "+se}T[q]=le+"@"+Q}C.path=T.join(",")}var te=c.headers=c.headers||{};c.subject&&(te.subject=c.subject),c.body&&(te.body=c.body);var ue=[];for(var W in te)te[W]!==Bc[W]&&ue.push(W.replace(Pt,Rn).replace(Pt,l).replace(es,F)+"="+te[W].replace(Pt,Rn).replace(Pt,l).replace(rl,F));return ue.length&&(C.query=ue.join("&")),C}},nl=/^([^\:]+)\:(.*)/,rs={scheme:"urn",parse:function(c,v){var C=c.path&&c.path.match(nl),T=c;if(C){var q=v.scheme||T.scheme||"urn",K=C[1].toLowerCase(),x=C[2],ae=q+":"+(v.nid||K),le=z[ae];T.nid=K,T.nss=x,T.path=void 0,le&&(T=le.parse(T,v))}else T.error=T.error||"URN can not be parsed.";return T},serialize:function(c,v){var C=v.scheme||c.scheme||"urn",T=c.nid,q=C+":"+(v.nid||T),K=z[q];K&&(c=K.serialize(c,v));var x=c,ae=c.nss;return x.path=(T||v.nid)+":"+ae,x}},al=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,ns={scheme:"urn:uuid",parse:function(c,v){var C=c;return C.uuid=C.nss,C.nss=void 0,!v.tolerant&&(!C.uuid||!C.uuid.match(al))&&(C.error=C.error||"UUID is not valid."),C},serialize:function(c,v){var C=c;return C.nss=(c.uuid||"").toLowerCase(),C}};z[ot.scheme]=ot,z[Xa.scheme]=Xa,z[Xt.scheme]=Xt,z[Za.scheme]=Za,z[ts.scheme]=ts,z[rs.scheme]=rs,z[ns.scheme]=ns,r.SCHEMES=z,r.pctEncChar=F,r.pctDecChars=X,r.parse=be,r.removeDotSegments=Me,r.serialize=we,r.resolveComponents=St,r.resolve=Bt,r.normalize=st,r.equal=Yt,r.escapeComponent=Or,r.unescapeComponent=Pe,Object.defineProperty(r,"__esModule",{value:!0})})})(Bo,ar),Object.defineProperty(Gr,"__esModule",{value:!0});const pa=ar;pa.code='require("ajv/dist/runtime/uri").default',Gr.default=pa,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.CodeGen=e.Name=e.nil=e.stringify=e.str=e._=e.KeywordCxt=void 0;var t=Ne;Object.defineProperty(e,"KeywordCxt",{enumerable:!0,get:function(){return t.KeywordCxt}});var r=J;Object.defineProperty(e,"_",{enumerable:!0,get:function(){return r._}}),Object.defineProperty(e,"str",{enumerable:!0,get:function(){return r.str}}),Object.defineProperty(e,"stringify",{enumerable:!0,get:function(){return r.stringify}}),Object.defineProperty(e,"nil",{enumerable:!0,get:function(){return r.nil}}),Object.defineProperty(e,"Name",{enumerable:!0,get:function(){return r.Name}}),Object.defineProperty(e,"CodeGen",{enumerable:!0,get:function(){return r.CodeGen}});const n=kt,a=Dt,s=Ze,l=ge,f=J,d=he,u=jt,i=ee,p=Jo,b=Gr,w=(V,S)=>new RegExp(V,S);w.code="new RegExp";const g=["removeAdditional","useDefaults","coerceTypes"],_=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),$={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},h={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},P=200;function O(V){var S,k,N,o,y,I,z,F,X,Z,ie,Ae,_t,Ht,Gt,be,Wt,wt,bt,Et,Jt,Me,we,St,Bt;const st=V.strict,Yt=(S=V.code)===null||S===void 0?void 0:S.optimize,Or=Yt===!0||Yt===void 0?1:Yt||0,Pe=(N=(k=V.code)===null||k===void 0?void 0:k.regExp)!==null&&N!==void 0?N:w,ot=(o=V.uriResolver)!==null&&o!==void 0?o:b.default;return{strictSchema:(I=(y=V.strictSchema)!==null&&y!==void 0?y:st)!==null&&I!==void 0?I:!0,strictNumbers:(F=(z=V.strictNumbers)!==null&&z!==void 0?z:st)!==null&&F!==void 0?F:!0,strictTypes:(Z=(X=V.strictTypes)!==null&&X!==void 0?X:st)!==null&&Z!==void 0?Z:"log",strictTuples:(Ae=(ie=V.strictTuples)!==null&&ie!==void 0?ie:st)!==null&&Ae!==void 0?Ae:"log",strictRequired:(Ht=(_t=V.strictRequired)!==null&&_t!==void 0?_t:st)!==null&&Ht!==void 0?Ht:!1,code:V.code?{...V.code,optimize:Or,regExp:Pe}:{optimize:Or,regExp:Pe},loopRequired:(Gt=V.loopRequired)!==null&&Gt!==void 0?Gt:P,loopEnum:(be=V.loopEnum)!==null&&be!==void 0?be:P,meta:(Wt=V.meta)!==null&&Wt!==void 0?Wt:!0,messages:(wt=V.messages)!==null&&wt!==void 0?wt:!0,inlineRefs:(bt=V.inlineRefs)!==null&&bt!==void 0?bt:!0,schemaId:(Et=V.schemaId)!==null&&Et!==void 0?Et:"$id",addUsedSchema:(Jt=V.addUsedSchema)!==null&&Jt!==void 0?Jt:!0,validateSchema:(Me=V.validateSchema)!==null&&Me!==void 0?Me:!0,validateFormats:(we=V.validateFormats)!==null&&we!==void 0?we:!0,unicodeRegExp:(St=V.unicodeRegExp)!==null&&St!==void 0?St:!0,int32range:(Bt=V.int32range)!==null&&Bt!==void 0?Bt:!0,uriResolver:ot}}class R{constructor(S={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,S=this.opts={...S,...O(S)};const{es5:k,lines:N}=this.opts.code;this.scope=new f.ValueScope({scope:{},prefixes:_,es5:k,lines:N}),this.logger=H(S.logger);const o=S.validateFormats;S.validateFormats=!1,this.RULES=(0,s.getRules)(),D.call(this,$,S,"NOT SUPPORTED"),D.call(this,h,S,"DEPRECATED","warn"),this._metaOpts=U.call(this),S.formats&&A.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),S.keywords&&M.call(this,S.keywords),typeof S.meta=="object"&&this.addMetaSchema(S.meta),j.call(this),S.validateFormats=o}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){const{$data:S,meta:k,schemaId:N}=this.opts;let o=p;N==="id"&&(o={...p},o.id=o.$id,delete o.$id),k&&S&&this.addMetaSchema(o,o[N],!1)}defaultMeta(){const{meta:S,schemaId:k}=this.opts;return this.opts.defaultMeta=typeof S=="object"?S[k]||S:void 0}validate(S,k){let N;if(typeof S=="string"){if(N=this.getSchema(S),!N)throw new Error(`no schema with key or ref "${S}"`)}else N=this.compile(S);const o=N(k);return"$async"in N||(this.errors=N.errors),o}compile(S,k){const N=this._addSchema(S,k);return N.validate||this._compileSchemaEnv(N)}compileAsync(S,k){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");const{loadSchema:N}=this.opts;return o.call(this,S,k);async function o(Z,ie){await y.call(this,Z.$schema);const Ae=this._addSchema(Z,ie);return Ae.validate||I.call(this,Ae)}async function y(Z){Z&&!this.getSchema(Z)&&await o.call(this,{$ref:Z},!0)}async function I(Z){try{return this._compileSchemaEnv(Z)}catch(ie){if(!(ie instanceof a.default))throw ie;return z.call(this,ie),await F.call(this,ie.missingSchema),I.call(this,Z)}}function z({missingSchema:Z,missingRef:ie}){if(this.refs[Z])throw new Error(`AnySchema ${Z} is loaded but ${ie} cannot be resolved`)}async function F(Z){const ie=await X.call(this,Z);this.refs[Z]||await y.call(this,ie.$schema),this.refs[Z]||this.addSchema(ie,Z,k)}async function X(Z){const ie=this._loading[Z];if(ie)return ie;try{return await(this._loading[Z]=N(Z))}finally{delete this._loading[Z]}}}addSchema(S,k,N,o=this.opts.validateSchema){if(Array.isArray(S)){for(const I of S)this.addSchema(I,void 0,N,o);return this}let y;if(typeof S=="object"){const{schemaId:I}=this.opts;if(y=S[I],y!==void 0&&typeof y!="string")throw new Error(`schema ${I} must be string`)}return k=(0,d.normalizeId)(k||y),this._checkUnique(k),this.schemas[k]=this._addSchema(S,N,k,o,!0),this}addMetaSchema(S,k,N=this.opts.validateSchema){return this.addSchema(S,k,!0,N),this}validateSchema(S,k){if(typeof S=="boolean")return!0;let N;if(N=S.$schema,N!==void 0&&typeof N!="string")throw new Error("$schema must be a string");if(N=N||this.opts.defaultMeta||this.defaultMeta(),!N)return this.logger.warn("meta-schema not available"),this.errors=null,!0;const o=this.validate(N,S);if(!o&&k){const y="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(y);else throw new Error(y)}return o}getSchema(S){let k;for(;typeof(k=E.call(this,S))=="string";)S=k;if(k===void 0){const{schemaId:N}=this.opts,o=new l.SchemaEnv({schema:{},schemaId:N});if(k=l.resolveSchema.call(this,o,S),!k)return;this.refs[S]=k}return k.validate||this._compileSchemaEnv(k)}removeSchema(S){if(S instanceof RegExp)return this._removeAllSchemas(this.schemas,S),this._removeAllSchemas(this.refs,S),this;switch(typeof S){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{const k=E.call(this,S);return typeof k=="object"&&this._cache.delete(k.schema),delete this.schemas[S],delete this.refs[S],this}case"object":{const k=S;this._cache.delete(k);let N=S[this.opts.schemaId];return N&&(N=(0,d.normalizeId)(N),delete this.schemas[N],delete this.refs[N]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(S){for(const k of S)this.addKeyword(k);return this}addKeyword(S,k){let N;if(typeof S=="string")N=S,typeof k=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),k.keyword=N);else if(typeof S=="object"&&k===void 0){if(k=S,N=k.keyword,Array.isArray(N)&&!N.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(ne.call(this,N,k),!k)return(0,i.eachItem)(N,y=>Se.call(this,y)),this;$t.call(this,k);const o={...k,type:(0,u.getJSONTypes)(k.type),schemaType:(0,u.getJSONTypes)(k.schemaType)};return(0,i.eachItem)(N,o.type.length===0?y=>Se.call(this,y,o):y=>o.type.forEach(I=>Se.call(this,y,o,I))),this}getKeyword(S){const k=this.RULES.all[S];return typeof k=="object"?k.definition:!!k}removeKeyword(S){const{RULES:k}=this;delete k.keywords[S],delete k.all[S];for(const N of k.rules){const o=N.rules.findIndex(y=>y.keyword===S);o>=0&&N.rules.splice(o,1)}return this}addFormat(S,k){return typeof k=="string"&&(k=new RegExp(k)),this.formats[S]=k,this}errorsText(S=this.errors,{separator:k=", ",dataVar:N="data"}={}){return!S||S.length===0?"No errors":S.map(o=>`${N}${o.instancePath} ${o.message}`).reduce((o,y)=>o+k+y)}$dataMetaSchema(S,k){const N=this.RULES.all;S=JSON.parse(JSON.stringify(S));for(const o of k){const y=o.split("/").slice(1);let I=S;for(const z of y)I=I[z];for(const z in N){const F=N[z];if(typeof F!="object")continue;const{$data:X}=F.definition,Z=I[z];X&&Z&&(I[z]=gt(Z))}}return S}_removeAllSchemas(S,k){for(const N in S){const o=S[N];(!k||k.test(N))&&(typeof o=="string"?delete S[N]:o&&!o.meta&&(this._cache.delete(o.schema),delete S[N]))}}_addSchema(S,k,N,o=this.opts.validateSchema,y=this.opts.addUsedSchema){let I;const{schemaId:z}=this.opts;if(typeof S=="object")I=S[z];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof S!="boolean")throw new Error("schema must be object or boolean")}let F=this._cache.get(S);if(F!==void 0)return F;N=(0,d.normalizeId)(I||N);const X=d.getSchemaRefs.call(this,S,N);return F=new l.SchemaEnv({schema:S,schemaId:z,meta:k,baseId:N,localRefs:X}),this._cache.set(F.schema,F),y&&!N.startsWith("#")&&(N&&this._checkUnique(N),this.refs[N]=F),o&&this.validateSchema(S,!0),F}_checkUnique(S){if(this.schemas[S]||this.refs[S])throw new Error(`schema with key or id "${S}" already exists`)}_compileSchemaEnv(S){if(S.meta?this._compileMetaSchema(S):l.compileSchema.call(this,S),!S.validate)throw new Error("ajv implementation error");return S.validate}_compileMetaSchema(S){const k=this.opts;this.opts=this._metaOpts;try{l.compileSchema.call(this,S)}finally{this.opts=k}}}e.default=R,R.ValidationError=n.default,R.MissingRefError=a.default;function D(V,S,k,N="error"){for(const o in V){const y=o;y in S&&this.logger[N](`${k}: option ${o}. ${V[y]}`)}}function E(V){return V=(0,d.normalizeId)(V),this.schemas[V]||this.refs[V]}function j(){const V=this.opts.schemas;if(V)if(Array.isArray(V))this.addSchema(V);else for(const S in V)this.addSchema(V[S],S)}function A(){for(const V in this.opts.formats){const S=this.opts.formats[V];S&&this.addFormat(V,S)}}function M(V){if(Array.isArray(V)){this.addVocabulary(V);return}this.logger.warn("keywords option as map is deprecated, pass array");for(const S in V){const k=V[S];k.keyword||(k.keyword=S),this.addKeyword(k)}}function U(){const V={...this.opts};for(const S of g)delete V[S];return V}const B={log(){},warn(){},error(){}};function H(V){if(V===!1)return B;if(V===void 0)return console;if(V.log&&V.warn&&V.error)return V;throw new Error("logger must implement log, warn and error methods")}const de=/^[a-z_$][a-z0-9_$:-]*$/i;function ne(V,S){const{RULES:k}=this;if((0,i.eachItem)(V,N=>{if(k.keywords[N])throw new Error(`Keyword ${N} is already defined`);if(!de.test(N))throw new Error(`Keyword ${N} has invalid name`)}),!!S&&S.$data&&!("code"in S||"validate"in S))throw new Error('$data keyword must have "code" or "validate" function')}function Se(V,S,k){var N;const o=S==null?void 0:S.post;if(k&&o)throw new Error('keyword with "post" flag cannot have "type"');const{RULES:y}=this;let I=o?y.post:y.rules.find(({type:F})=>F===k);if(I||(I={type:k,rules:[]},y.rules.push(I)),y.keywords[V]=!0,!S)return;const z={keyword:V,definition:{...S,type:(0,u.getJSONTypes)(S.type),schemaType:(0,u.getJSONTypes)(S.schemaType)}};S.before?at.call(this,I,z,S.before):I.rules.push(z),y.all[V]=z,(N=S.implements)===null||N===void 0||N.forEach(F=>this.addKeyword(F))}function at(V,S,k){const N=V.rules.findIndex(o=>o.keyword===k);N>=0?V.rules.splice(N,0,S):(V.rules.push(S),this.logger.warn(`rule ${k} is not defined`))}function $t(V){let{metaSchema:S}=V;S!==void 0&&(V.$data&&this.opts.$data&&(S=gt(S)),V.validateSchema=this.compile(S,!0))}const Kt={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function gt(V){return{anyOf:[V,Kt]}}}(Mn);var Wr={},Jr={},Br={};Object.defineProperty(Br,"__esModule",{value:!0});const Yo={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};Br.default=Yo;var tt={};Object.defineProperty(tt,"__esModule",{value:!0}),tt.callRef=tt.getValidate=void 0;const Xo=Dt,ma=Y,_e=J,ft=Re,ha=ge,sr=ee,Qo={keyword:"$ref",schemaType:"string",code(e){const{gen:t,schema:r,it:n}=e,{baseId:a,schemaEnv:s,validateName:l,opts:f,self:d}=n,{root:u}=s;if((r==="#"||r==="#/")&&a===u.baseId)return p();const i=ha.resolveRef.call(d,u,a,r);if(i===void 0)throw new Xo.default(n.opts.uriResolver,a,r);if(i instanceof ha.SchemaEnv)return b(i);return w(i);function p(){if(s===u)return or(e,l,s,s.$async);const g=t.scopeValue("root",{ref:u});return or(e,(0,_e._)`${g}.validate`,u,u.$async)}function b(g){const _=ya(e,g);or(e,_,g,g.$async)}function w(g){const _=t.scopeValue("schema",f.code.source===!0?{ref:g,code:(0,_e.stringify)(g)}:{ref:g}),$=t.name("valid"),h=e.subschema({schema:g,dataTypes:[],schemaPath:_e.nil,topSchemaRef:_,errSchemaPath:r},$);e.mergeEvaluated(h),e.ok($)}}};function ya(e,t){const{gen:r}=e;return t.validate?r.scopeValue("validate",{ref:t.validate}):(0,_e._)`${r.scopeValue("wrapper",{ref:t})}.validate`}tt.getValidate=ya;function or(e,t,r,n){const{gen:a,it:s}=e,{allErrors:l,schemaEnv:f,opts:d}=s,u=d.passContext?ft.default.this:_e.nil;n?i():p();function i(){if(!f.$async)throw new Error("async schema referenced by sync schema");const g=a.let("valid");a.try(()=>{a.code((0,_e._)`await ${(0,ma.callValidateCode)(e,t,u)}`),w(t),l||a.assign(g,!0)},_=>{a.if((0,_e._)`!(${_} instanceof ${s.ValidationError})`,()=>a.throw(_)),b(_),l||a.assign(g,!1)}),e.ok(g)}function p(){e.result((0,ma.callValidateCode)(e,t,u),()=>w(t),()=>b(t))}function b(g){const _=(0,_e._)`${g}.errors`;a.assign(ft.default.vErrors,(0,_e._)`${ft.default.vErrors} === null ? ${_} : ${ft.default.vErrors}.concat(${_})`),a.assign(ft.default.errors,(0,_e._)`${ft.default.vErrors}.length`)}function w(g){var _;if(!s.opts.unevaluated)return;const $=(_=r==null?void 0:r.validate)===null||_===void 0?void 0:_.evaluated;if(s.props!==!0)if($&&!$.dynamicProps)$.props!==void 0&&(s.props=sr.mergeEvaluated.props(a,$.props,s.props));else{const h=a.var("props",(0,_e._)`${g}.evaluated.props`);s.props=sr.mergeEvaluated.props(a,h,s.props,_e.Name)}if(s.items!==!0)if($&&!$.dynamicItems)$.items!==void 0&&(s.items=sr.mergeEvaluated.items(a,$.items,s.items));else{const h=a.var("items",(0,_e._)`${g}.evaluated.items`);s.items=sr.mergeEvaluated.items(a,h,s.items,_e.Name)}}}tt.callRef=or,tt.default=Qo,Object.defineProperty(Jr,"__esModule",{value:!0});const Zo=Br,xo=tt,ei=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",Zo.default,xo.default];Jr.default=ei;var Yr={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});const ir=J,Be=ir.operators,cr={maximum:{okStr:"<=",ok:Be.LTE,fail:Be.GT},minimum:{okStr:">=",ok:Be.GTE,fail:Be.LT},exclusiveMaximum:{okStr:"<",ok:Be.LT,fail:Be.GTE},exclusiveMinimum:{okStr:">",ok:Be.GT,fail:Be.LTE}},ti={message:({keyword:e,schemaCode:t})=>(0,ir.str)`must be ${cr[e].okStr} ${t}`,params:({keyword:e,schemaCode:t})=>(0,ir._)`{comparison: ${cr[e].okStr}, limit: ${t}}`},ri={keyword:Object.keys(cr),type:"number",schemaType:"number",$data:!0,error:ti,code(e){const{keyword:t,data:r,schemaCode:n}=e;e.fail$data((0,ir._)`${r} ${cr[t].fail} ${n} || isNaN(${r})`)}};Xr.default=ri;var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});const At=J,ni={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:{message:({schemaCode:e})=>(0,At.str)`must be multiple of ${e}`,params:({schemaCode:e})=>(0,At._)`{multipleOf: ${e}}`},code(e){const{gen:t,data:r,schemaCode:n,it:a}=e,s=a.opts.multipleOfPrecision,l=t.let("res"),f=s?(0,At._)`Math.abs(Math.round(${l}) - ${l}) > 1e-${s}`:(0,At._)`${l} !== parseInt(${l})`;e.fail$data((0,At._)`(${n} === 0 || (${l} = ${r}/${n}, ${f}))`)}};Qr.default=ni;var Zr={},xr={};Object.defineProperty(xr,"__esModule",{value:!0});function va(e){const t=e.length;let r=0,n=0,a;for(;n<t;)r++,a=e.charCodeAt(n++),a>=55296&&a<=56319&&n<t&&(a=e.charCodeAt(n),(a&64512)===56320&&n++);return r}xr.default=va,va.code='require("ajv/dist/runtime/ucs2length").default',Object.defineProperty(Zr,"__esModule",{value:!0});const rt=J,ai=ee,si=xr,oi={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r=e==="maxLength"?"more":"fewer";return(0,rt.str)`must NOT have ${r} than ${t} characters`},params:({schemaCode:e})=>(0,rt._)`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n,it:a}=e,s=t==="maxLength"?rt.operators.GT:rt.operators.LT,l=a.opts.unicode===!1?(0,rt._)`${r}.length`:(0,rt._)`${(0,ai.useFunc)(e.gen,si.default)}(${r})`;e.fail$data((0,rt._)`${l} ${s} ${n}`)}};Zr.default=oi;var en={};Object.defineProperty(en,"__esModule",{value:!0});const ii=Y,lr=J,ci={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>(0,lr.str)`must match pattern "${e}"`,params:({schemaCode:e})=>(0,lr._)`{pattern: ${e}}`},code(e){const{data:t,$data:r,schema:n,schemaCode:a,it:s}=e,l=s.opts.unicodeRegExp?"u":"",f=r?(0,lr._)`(new RegExp(${a}, ${l}))`:(0,ii.usePattern)(e,n);e.fail$data((0,lr._)`!${f}.test(${t})`)}};en.default=ci;var tn={};Object.defineProperty(tn,"__esModule",{value:!0});const Mt=J,li={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r=e==="maxProperties"?"more":"fewer";return(0,Mt.str)`must NOT have ${r} than ${t} properties`},params:({schemaCode:e})=>(0,Mt._)`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,a=t==="maxProperties"?Mt.operators.GT:Mt.operators.LT;e.fail$data((0,Mt._)`Object.keys(${r}).length ${a} ${n}`)}};tn.default=li;var rn={};Object.defineProperty(rn,"__esModule",{value:!0});const Vt=Y,zt=J,ui=ee,di={keyword:"required",type:"object",schemaType:"array",$data:!0,error:{message:({params:{missingProperty:e}})=>(0,zt.str)`must have required property '${e}'`,params:({params:{missingProperty:e}})=>(0,zt._)`{missingProperty: ${e}}`},code(e){const{gen:t,schema:r,schemaCode:n,data:a,$data:s,it:l}=e,{opts:f}=l;if(!s&&r.length===0)return;const d=r.length>=f.loopRequired;if(l.allErrors?u():i(),f.strictRequired){const w=e.parentSchema.properties,{definedProperties:g}=e.it;for(const _ of r)if((w==null?void 0:w[_])===void 0&&!g.has(_)){const $=l.schemaEnv.baseId+l.errSchemaPath,h=`required property "${_}" is not defined at "${$}" (strictRequired)`;(0,ui.checkStrictMode)(l,h,l.opts.strictRequired)}}function u(){if(d||s)e.block$data(zt.nil,p);else for(const w of r)(0,Vt.checkReportMissingProp)(e,w)}function i(){const w=t.let("missing");if(d||s){const g=t.let("valid",!0);e.block$data(g,()=>b(w,g)),e.ok(g)}else t.if((0,Vt.checkMissingProp)(e,r,w)),(0,Vt.reportMissingProp)(e,w),t.else()}function p(){t.forOf("prop",n,w=>{e.setParams({missingProperty:w}),t.if((0,Vt.noPropertyInData)(t,a,w,f.ownProperties),()=>e.error())})}function b(w,g){e.setParams({missingProperty:w}),t.forOf(w,n,()=>{t.assign(g,(0,Vt.propertyInData)(t,a,w,f.ownProperties)),t.if((0,zt.not)(g),()=>{e.error(),t.break()})},zt.nil)}}};rn.default=di;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});const Ft=J,fi={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:{message({keyword:e,schemaCode:t}){const r=e==="maxItems"?"more":"fewer";return(0,Ft.str)`must NOT have ${r} than ${t} items`},params:({schemaCode:e})=>(0,Ft._)`{limit: ${e}}`},code(e){const{keyword:t,data:r,schemaCode:n}=e,a=t==="maxItems"?Ft.operators.GT:Ft.operators.LT;e.fail$data((0,Ft._)`${r}.length ${a} ${n}`)}};nn.default=fi;var an={},Ut={};Object.defineProperty(Ut,"__esModule",{value:!0});const $a=Wn;$a.code='require("ajv/dist/runtime/equal").default',Ut.default=$a,Object.defineProperty(an,"__esModule",{value:!0});const sn=jt,ye=J,pi=ee,mi=Ut,hi={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:{message:({params:{i:e,j:t}})=>(0,ye.str)`must NOT have duplicate items (items ## ${t} and ${e} are identical)`,params:({params:{i:e,j:t}})=>(0,ye._)`{i: ${e}, j: ${t}}`},code(e){const{gen:t,data:r,$data:n,schema:a,parentSchema:s,schemaCode:l,it:f}=e;if(!n&&!a)return;const d=t.let("valid"),u=s.items?(0,sn.getSchemaTypes)(s.items):[];e.block$data(d,i,(0,ye._)`${l} === false`),e.ok(d);function i(){const g=t.let("i",(0,ye._)`${r}.length`),_=t.let("j");e.setParams({i:g,j:_}),t.assign(d,!0),t.if((0,ye._)`${g} > 1`,()=>(p()?b:w)(g,_))}function p(){return u.length>0&&!u.some(g=>g==="object"||g==="array")}function b(g,_){const $=t.name("item"),h=(0,sn.checkDataTypes)(u,$,f.opts.strictNumbers,sn.DataType.Wrong),P=t.const("indices",(0,ye._)`{}`);t.for((0,ye._)`;${g}--;`,()=>{t.let($,(0,ye._)`${r}[${g}]`),t.if(h,(0,ye._)`continue`),u.length>1&&t.if((0,ye._)`typeof ${$} == "string"`,(0,ye._)`${$} += "_"`),t.if((0,ye._)`typeof ${P}[${$}] == "number"`,()=>{t.assign(_,(0,ye._)`${P}[${$}]`),e.error(),t.assign(d,!1).break()}).code((0,ye._)`${P}[${$}] = ${g}`)})}function w(g,_){const $=(0,pi.useFunc)(t,mi.default),h=t.name("outer");t.label(h).for((0,ye._)`;${g}--;`,()=>t.for((0,ye._)`${_} = ${g}; ${_}--;`,()=>t.if((0,ye._)`${$}(${r}[${g}], ${r}[${_}])`,()=>{e.error(),t.assign(d,!1).break(h)})))}}};an.default=hi;var on={};Object.defineProperty(on,"__esModule",{value:!0});const cn=J,yi=ee,vi=Ut,$i={keyword:"const",$data:!0,error:{message:"must be equal to constant",params:({schemaCode:e})=>(0,cn._)`{allowedValue: ${e}}`},code(e){const{gen:t,data:r,$data:n,schemaCode:a,schema:s}=e;n||s&&typeof s=="object"?e.fail$data((0,cn._)`!${(0,yi.useFunc)(t,vi.default)}(${r}, ${a})`):e.fail((0,cn._)`${s} !== ${r}`)}};on.default=$i;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});const Lt=J,gi=ee,_i=Ut,wi={keyword:"enum",schemaType:"array",$data:!0,error:{message:"must be equal to one of the allowed values",params:({schemaCode:e})=>(0,Lt._)`{allowedValues: ${e}}`},code(e){const{gen:t,data:r,$data:n,schema:a,schemaCode:s,it:l}=e;if(!n&&a.length===0)throw new Error("enum must have non-empty array");const f=a.length>=l.opts.loopEnum;let d;const u=()=>d??(d=(0,gi.useFunc)(t,_i.default));let i;if(f||n)i=t.let("valid"),e.block$data(i,p);else{if(!Array.isArray(a))throw new Error("ajv implementation error");const w=t.const("vSchema",s);i=(0,Lt.or)(...a.map((g,_)=>b(w,_)))}e.pass(i);function p(){t.assign(i,!1),t.forOf("v",s,w=>t.if((0,Lt._)`${u()}(${r}, ${w})`,()=>t.assign(i,!0).break()))}function b(w,g){const _=a[g];return typeof _=="object"&&_!==null?(0,Lt._)`${u()}(${r}, ${w}[${g}])`:(0,Lt._)`${r} === ${_}`}}};ln.default=wi,Object.defineProperty(Yr,"__esModule",{value:!0});const bi=Xr,Ei=Qr,Si=Zr,Pi=en,Oi=tn,Ni=rn,Ti=nn,Ci=an,ji=on,Ri=ln,Ii=[bi.default,Ei.default,Si.default,Pi.default,Oi.default,Ni.default,Ti.default,Ci.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},ji.default,Ri.default];Yr.default=Ii;var un={},pt={};Object.defineProperty(pt,"__esModule",{value:!0}),pt.validateAdditionalItems=void 0;const nt=J,dn=ee,ki={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:{message:({params:{len:e}})=>(0,nt.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,nt._)`{limit: ${e}}`},code(e){const{parentSchema:t,it:r}=e,{items:n}=t;if(!Array.isArray(n)){(0,dn.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}ga(e,n)}};function ga(e,t){const{gen:r,schema:n,data:a,keyword:s,it:l}=e;l.items=!0;const f=r.const("len",(0,nt._)`${a}.length`);if(n===!1)e.setParams({len:t.length}),e.pass((0,nt._)`${f} <= ${t.length}`);else if(typeof n=="object"&&!(0,dn.alwaysValidSchema)(l,n)){const u=r.var("valid",(0,nt._)`${f} <= ${t.length}`);r.if((0,nt.not)(u),()=>d(u)),e.ok(u)}function d(u){r.forRange("i",t.length,f,i=>{e.subschema({keyword:s,dataProp:i,dataPropType:dn.Type.Num},u),l.allErrors||r.if((0,nt.not)(u),()=>r.break())})}}pt.validateAdditionalItems=ga,pt.default=ki;var fn={},mt={};Object.defineProperty(mt,"__esModule",{value:!0}),mt.validateTuple=void 0;const _a=J,ur=ee,Di=Y,Ai={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(e){const{schema:t,it:r}=e;if(Array.isArray(t))return wa(e,"additionalItems",t);r.items=!0,!(0,ur.alwaysValidSchema)(r,t)&&e.ok((0,Di.validateArray)(e))}};function wa(e,t,r=e.schema){const{gen:n,parentSchema:a,data:s,keyword:l,it:f}=e;i(a),f.opts.unevaluated&&r.length&&f.items!==!0&&(f.items=ur.mergeEvaluated.items(n,r.length,f.items));const d=n.name("valid"),u=n.const("len",(0,_a._)`${s}.length`);r.forEach((p,b)=>{(0,ur.alwaysValidSchema)(f,p)||(n.if((0,_a._)`${u} > ${b}`,()=>e.subschema({keyword:l,schemaProp:b,dataProp:b},d)),e.ok(d))});function i(p){const{opts:b,errSchemaPath:w}=f,g=r.length,_=g===p.minItems&&(g===p.maxItems||p[t]===!1);if(b.strictTuples&&!_){const $=`"${l}" is ${g}-tuple, but minItems or maxItems/${t} are not specified or different at path "${w}"`;(0,ur.checkStrictMode)(f,$,b.strictTuples)}}}mt.validateTuple=wa,mt.default=Ai,Object.defineProperty(fn,"__esModule",{value:!0});const Mi=mt,Vi={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:e=>(0,Mi.validateTuple)(e,"items")};fn.default=Vi;var pn={};Object.defineProperty(pn,"__esModule",{value:!0});const ba=J,zi=ee,Fi=Y,Ui=pt,Li={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:{message:({params:{len:e}})=>(0,ba.str)`must NOT have more than ${e} items`,params:({params:{len:e}})=>(0,ba._)`{limit: ${e}}`},code(e){const{schema:t,parentSchema:r,it:n}=e,{prefixItems:a}=r;n.items=!0,!(0,zi.alwaysValidSchema)(n,t)&&(a?(0,Ui.validateAdditionalItems)(e,a):e.ok((0,Fi.validateArray)(e)))}};pn.default=Li;var mn={};Object.defineProperty(mn,"__esModule",{value:!0});const Ee=J,dr=ee,qi={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:{message:({params:{min:e,max:t}})=>t===void 0?(0,Ee.str)`must contain at least ${e} valid item(s)`:(0,Ee.str)`must contain at least ${e} and no more than ${t} valid item(s)`,params:({params:{min:e,max:t}})=>t===void 0?(0,Ee._)`{minContains: ${e}}`:(0,Ee._)`{minContains: ${e}, maxContains: ${t}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:a,it:s}=e;let l,f;const{minContains:d,maxContains:u}=n;s.opts.next?(l=d===void 0?1:d,f=u):l=1;const i=t.const("len",(0,Ee._)`${a}.length`);if(e.setParams({min:l,max:f}),f===void 0&&l===0){(0,dr.checkStrictMode)(s,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(f!==void 0&&l>f){(0,dr.checkStrictMode)(s,'"minContains" > "maxContains" is always invalid'),e.fail();return}if((0,dr.alwaysValidSchema)(s,r)){let _=(0,Ee._)`${i} >= ${l}`;f!==void 0&&(_=(0,Ee._)`${_} && ${i} <= ${f}`),e.pass(_);return}s.items=!0;const p=t.name("valid");f===void 0&&l===1?w(p,()=>t.if(p,()=>t.break())):l===0?(t.let(p,!0),f!==void 0&&t.if((0,Ee._)`${a}.length > 0`,b)):(t.let(p,!1),b()),e.result(p,()=>e.reset());function b(){const _=t.name("_valid"),$=t.let("count",0);w(_,()=>t.if(_,()=>g($)))}function w(_,$){t.forRange("i",0,i,h=>{e.subschema({keyword:"contains",dataProp:h,dataPropType:dr.Type.Num,compositeRule:!0},_),$()})}function g(_){t.code((0,Ee._)`${_}++`),f===void 0?t.if((0,Ee._)`${_} >= ${l}`,()=>t.assign(p,!0).break()):(t.if((0,Ee._)`${_} > ${f}`,()=>t.assign(p,!1).break()),l===1?t.assign(p,!0):t.if((0,Ee._)`${_} >= ${l}`,()=>t.assign(p,!0)))}}};mn.default=qi;var Ea={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateSchemaDeps=e.validatePropertyDeps=e.error=void 0;const t=J,r=ee,n=Y;e.error={message:({params:{property:d,depsCount:u,deps:i}})=>{const p=u===1?"property":"properties";return(0,t.str)`must have ${p} ${i} when property ${d} is present`},params:({params:{property:d,depsCount:u,deps:i,missingProperty:p}})=>(0,t._)`{property: ${d},
    missingProperty: ${p},
    depsCount: ${u},
    deps: ${i}}`};const a={keyword:"dependencies",type:"object",schemaType:"object",error:e.error,code(d){const[u,i]=s(d);l(d,u),f(d,i)}};function s({schema:d}){const u={},i={};for(const p in d){if(p==="__proto__")continue;const b=Array.isArray(d[p])?u:i;b[p]=d[p]}return[u,i]}function l(d,u=d.schema){const{gen:i,data:p,it:b}=d;if(Object.keys(u).length===0)return;const w=i.let("missing");for(const g in u){const _=u[g];if(_.length===0)continue;const $=(0,n.propertyInData)(i,p,g,b.opts.ownProperties);d.setParams({property:g,depsCount:_.length,deps:_.join(", ")}),b.allErrors?i.if($,()=>{for(const h of _)(0,n.checkReportMissingProp)(d,h)}):(i.if((0,t._)`${$} && (${(0,n.checkMissingProp)(d,_,w)})`),(0,n.reportMissingProp)(d,w),i.else())}}e.validatePropertyDeps=l;function f(d,u=d.schema){const{gen:i,data:p,keyword:b,it:w}=d,g=i.name("valid");for(const _ in u)(0,r.alwaysValidSchema)(w,u[_])||(i.if((0,n.propertyInData)(i,p,_,w.opts.ownProperties),()=>{const $=d.subschema({keyword:b,schemaProp:_},g);d.mergeValidEvaluated($,g)},()=>i.var(g,!0)),d.ok(g))}e.validateSchemaDeps=f,e.default=a})(Ea);var hn={};Object.defineProperty(hn,"__esModule",{value:!0});const Sa=J,Ki=ee,Hi={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:{message:"property name must be valid",params:({params:e})=>(0,Sa._)`{propertyName: ${e.propertyName}}`},code(e){const{gen:t,schema:r,data:n,it:a}=e;if((0,Ki.alwaysValidSchema)(a,r))return;const s=t.name("valid");t.forIn("key",n,l=>{e.setParams({propertyName:l}),e.subschema({keyword:"propertyNames",data:l,dataTypes:["string"],propertyName:l,compositeRule:!0},s),t.if((0,Sa.not)(s),()=>{e.error(!0),a.allErrors||t.break()})}),e.ok(s)}};hn.default=Hi;var fr={};Object.defineProperty(fr,"__esModule",{value:!0});const pr=Y,je=J,Gi=Re,mr=ee,Wi={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:{message:"must NOT have additional properties",params:({params:e})=>(0,je._)`{additionalProperty: ${e.additionalProperty}}`},code(e){const{gen:t,schema:r,parentSchema:n,data:a,errsCount:s,it:l}=e;if(!s)throw new Error("ajv implementation error");const{allErrors:f,opts:d}=l;if(l.props=!0,d.removeAdditional!=="all"&&(0,mr.alwaysValidSchema)(l,r))return;const u=(0,pr.allSchemaProperties)(n.properties),i=(0,pr.allSchemaProperties)(n.patternProperties);p(),e.ok((0,je._)`${s} === ${Gi.default.errors}`);function p(){t.forIn("key",a,$=>{!u.length&&!i.length?g($):t.if(b($),()=>g($))})}function b($){let h;if(u.length>8){const P=(0,mr.schemaRefOrVal)(l,n.properties,"properties");h=(0,pr.isOwnProperty)(t,P,$)}else u.length?h=(0,je.or)(...u.map(P=>(0,je._)`${$} === ${P}`)):h=je.nil;return i.length&&(h=(0,je.or)(h,...i.map(P=>(0,je._)`${(0,pr.usePattern)(e,P)}.test(${$})`))),(0,je.not)(h)}function w($){t.code((0,je._)`delete ${a}[${$}]`)}function g($){if(d.removeAdditional==="all"||d.removeAdditional&&r===!1){w($);return}if(r===!1){e.setParams({additionalProperty:$}),e.error(),f||t.break();return}if(typeof r=="object"&&!(0,mr.alwaysValidSchema)(l,r)){const h=t.name("valid");d.removeAdditional==="failing"?(_($,h,!1),t.if((0,je.not)(h),()=>{e.reset(),w($)})):(_($,h),f||t.if((0,je.not)(h),()=>t.break()))}}function _($,h,P){const O={keyword:"additionalProperties",dataProp:$,dataPropType:mr.Type.Str};P===!1&&Object.assign(O,{compositeRule:!0,createErrors:!1,allErrors:!1}),e.subschema(O,h)}}};fr.default=Wi;var yn={};Object.defineProperty(yn,"__esModule",{value:!0});const Ji=Ne,Pa=Y,vn=ee,Oa=fr,Bi={keyword:"properties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,parentSchema:n,data:a,it:s}=e;s.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Oa.default.code(new Ji.KeywordCxt(s,Oa.default,"additionalProperties"));const l=(0,Pa.allSchemaProperties)(r);for(const p of l)s.definedProperties.add(p);s.opts.unevaluated&&l.length&&s.props!==!0&&(s.props=vn.mergeEvaluated.props(t,(0,vn.toHash)(l),s.props));const f=l.filter(p=>!(0,vn.alwaysValidSchema)(s,r[p]));if(f.length===0)return;const d=t.name("valid");for(const p of f)u(p)?i(p):(t.if((0,Pa.propertyInData)(t,a,p,s.opts.ownProperties)),i(p),s.allErrors||t.else().var(d,!0),t.endIf()),e.it.definedProperties.add(p),e.ok(d);function u(p){return s.opts.useDefaults&&!s.compositeRule&&r[p].default!==void 0}function i(p){e.subschema({keyword:"properties",schemaProp:p,dataProp:p},d)}}};yn.default=Bi;var $n={};Object.defineProperty($n,"__esModule",{value:!0});const Na=Y,hr=J,Ta=ee,Ca=ee,Yi={keyword:"patternProperties",type:"object",schemaType:"object",code(e){const{gen:t,schema:r,data:n,parentSchema:a,it:s}=e,{opts:l}=s,f=(0,Na.allSchemaProperties)(r),d=f.filter(_=>(0,Ta.alwaysValidSchema)(s,r[_]));if(f.length===0||d.length===f.length&&(!s.opts.unevaluated||s.props===!0))return;const u=l.strictSchema&&!l.allowMatchingProperties&&a.properties,i=t.name("valid");s.props!==!0&&!(s.props instanceof hr.Name)&&(s.props=(0,Ca.evaluatedPropsToName)(t,s.props));const{props:p}=s;b();function b(){for(const _ of f)u&&w(_),s.allErrors?g(_):(t.var(i,!0),g(_),t.if(i))}function w(_){for(const $ in u)new RegExp(_).test($)&&(0,Ta.checkStrictMode)(s,`property ${$} matches pattern ${_} (use allowMatchingProperties)`)}function g(_){t.forIn("key",n,$=>{t.if((0,hr._)`${(0,Na.usePattern)(e,_)}.test(${$})`,()=>{const h=d.includes(_);h||e.subschema({keyword:"patternProperties",schemaProp:_,dataProp:$,dataPropType:Ca.Type.Str},i),s.opts.unevaluated&&p!==!0?t.assign((0,hr._)`${p}[${$}]`,!0):!h&&!s.allErrors&&t.if((0,hr.not)(i),()=>t.break())})})}}};$n.default=Yi;var gn={};Object.defineProperty(gn,"__esModule",{value:!0});const Xi=ee,Qi={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(e){const{gen:t,schema:r,it:n}=e;if((0,Xi.alwaysValidSchema)(n,r)){e.fail();return}const a=t.name("valid");e.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},a),e.failResult(a,()=>e.reset(),()=>e.error())},error:{message:"must NOT be valid"}};gn.default=Qi;var _n={};Object.defineProperty(_n,"__esModule",{value:!0});const Zi={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:Y.validateUnion,error:{message:"must match a schema in anyOf"}};_n.default=Zi;var wn={};Object.defineProperty(wn,"__esModule",{value:!0});const yr=J,xi=ee,ec={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:{message:"must match exactly one schema in oneOf",params:({params:e})=>(0,yr._)`{passingSchemas: ${e.passing}}`},code(e){const{gen:t,schema:r,parentSchema:n,it:a}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");if(a.opts.discriminator&&n.discriminator)return;const s=r,l=t.let("valid",!1),f=t.let("passing",null),d=t.name("_valid");e.setParams({passing:f}),t.block(u),e.result(l,()=>e.reset(),()=>e.error(!0));function u(){s.forEach((i,p)=>{let b;(0,xi.alwaysValidSchema)(a,i)?t.var(d,!0):b=e.subschema({keyword:"oneOf",schemaProp:p,compositeRule:!0},d),p>0&&t.if((0,yr._)`${d} && ${l}`).assign(l,!1).assign(f,(0,yr._)`[${f}, ${p}]`).else(),t.if(d,()=>{t.assign(l,!0),t.assign(f,p),b&&e.mergeEvaluated(b,yr.Name)})})}}};wn.default=ec;var bn={};Object.defineProperty(bn,"__esModule",{value:!0});const tc=ee,rc={keyword:"allOf",schemaType:"array",code(e){const{gen:t,schema:r,it:n}=e;if(!Array.isArray(r))throw new Error("ajv implementation error");const a=t.name("valid");r.forEach((s,l)=>{if((0,tc.alwaysValidSchema)(n,s))return;const f=e.subschema({keyword:"allOf",schemaProp:l},a);e.ok(a),e.mergeEvaluated(f)})}};bn.default=rc;var En={};Object.defineProperty(En,"__esModule",{value:!0});const vr=J,ja=ee,nc={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:{message:({params:e})=>(0,vr.str)`must match "${e.ifClause}" schema`,params:({params:e})=>(0,vr._)`{failingKeyword: ${e.ifClause}}`},code(e){const{gen:t,parentSchema:r,it:n}=e;r.then===void 0&&r.else===void 0&&(0,ja.checkStrictMode)(n,'"if" without "then" and "else" is ignored');const a=Ra(n,"then"),s=Ra(n,"else");if(!a&&!s)return;const l=t.let("valid",!0),f=t.name("_valid");if(d(),e.reset(),a&&s){const i=t.let("ifClause");e.setParams({ifClause:i}),t.if(f,u("then",i),u("else",i))}else a?t.if(f,u("then")):t.if((0,vr.not)(f),u("else"));e.pass(l,()=>e.error(!0));function d(){const i=e.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},f);e.mergeEvaluated(i)}function u(i,p){return()=>{const b=e.subschema({keyword:i},f);t.assign(l,f),e.mergeValidEvaluated(b,l),p?t.assign(p,(0,vr._)`${i}`):e.setParams({ifClause:i})}}}};function Ra(e,t){const r=e.schema[t];return r!==void 0&&!(0,ja.alwaysValidSchema)(e,r)}En.default=nc;var Sn={};Object.defineProperty(Sn,"__esModule",{value:!0});const ac=ee,sc={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:e,parentSchema:t,it:r}){t.if===void 0&&(0,ac.checkStrictMode)(r,`"${e}" without "if" is ignored`)}};Sn.default=sc,Object.defineProperty(un,"__esModule",{value:!0});const oc=pt,ic=fn,cc=mt,lc=pn,uc=mn,dc=Ea,fc=hn,pc=fr,mc=yn,hc=$n,yc=gn,vc=_n,$c=wn,gc=bn,_c=En,wc=Sn;function bc(e=!1){const t=[yc.default,vc.default,$c.default,gc.default,_c.default,wc.default,fc.default,pc.default,dc.default,mc.default,hc.default];return e?t.push(ic.default,lc.default):t.push(oc.default,cc.default),t.push(uc.default),t}un.default=bc;var Pn={},On={};Object.defineProperty(On,"__esModule",{value:!0});const ce=J,Ec={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:{message:({schemaCode:e})=>(0,ce.str)`must match format "${e}"`,params:({schemaCode:e})=>(0,ce._)`{format: ${e}}`},code(e,t){const{gen:r,data:n,$data:a,schema:s,schemaCode:l,it:f}=e,{opts:d,errSchemaPath:u,schemaEnv:i,self:p}=f;if(!d.validateFormats)return;a?b():w();function b(){const g=r.scopeValue("formats",{ref:p.formats,code:d.code.formats}),_=r.const("fDef",(0,ce._)`${g}[${l}]`),$=r.let("fType"),h=r.let("format");r.if((0,ce._)`typeof ${_} == "object" && !(${_} instanceof RegExp)`,()=>r.assign($,(0,ce._)`${_}.type || "string"`).assign(h,(0,ce._)`${_}.validate`),()=>r.assign($,(0,ce._)`"string"`).assign(h,_)),e.fail$data((0,ce.or)(P(),O()));function P(){return d.strictSchema===!1?ce.nil:(0,ce._)`${l} && !${h}`}function O(){const R=i.$async?(0,ce._)`(${_}.async ? await ${h}(${n}) : ${h}(${n}))`:(0,ce._)`${h}(${n})`,D=(0,ce._)`(typeof ${h} == "function" ? ${R} : ${h}.test(${n}))`;return(0,ce._)`${h} && ${h} !== true && ${$} === ${t} && !${D}`}}function w(){const g=p.formats[s];if(!g){P();return}if(g===!0)return;const[_,$,h]=O(g);_===t&&e.pass(R());function P(){if(d.strictSchema===!1){p.logger.warn(D());return}throw new Error(D());function D(){return`unknown format "${s}" ignored in schema at path "${u}"`}}function O(D){const E=D instanceof RegExp?(0,ce.regexpCode)(D):d.code.formats?(0,ce._)`${d.code.formats}${(0,ce.getProperty)(s)}`:void 0,j=r.scopeValue("formats",{key:s,ref:D,code:E});return typeof D=="object"&&!(D instanceof RegExp)?[D.type||"string",D.validate,(0,ce._)`${j}.validate`]:["string",D,j]}function R(){if(typeof g=="object"&&!(g instanceof RegExp)&&g.async){if(!i.$async)throw new Error("async format in sync schema");return(0,ce._)`await ${h}(${n})`}return typeof $=="function"?(0,ce._)`${h}(${n})`:(0,ce._)`${h}.test(${n})`}}}};On.default=Ec,Object.defineProperty(Pn,"__esModule",{value:!0});const Sc=[On.default];Pn.default=Sc;var ht={};Object.defineProperty(ht,"__esModule",{value:!0}),ht.contentVocabulary=ht.metadataVocabulary=void 0,ht.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"],ht.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"],Object.defineProperty(Wr,"__esModule",{value:!0});const Pc=Jr,Oc=Yr,Nc=un,Tc=Pn,Ia=ht,Cc=[Pc.default,Oc.default,(0,Nc.default)(),Tc.default,Ia.metadataVocabulary,Ia.contentVocabulary];Wr.default=Cc;var Nn={},ka={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.DiscrError=void 0,function(t){t.Tag="tag",t.Mapping="mapping"}(e.DiscrError||(e.DiscrError={}))})(ka),Object.defineProperty(Nn,"__esModule",{value:!0});const yt=J,Tn=ka,Da=ge,jc=ee,Rc={keyword:"discriminator",type:"object",schemaType:"object",error:{message:({params:{discrError:e,tagName:t}})=>e===Tn.DiscrError.Tag?`tag "${t}" must be string`:`value of tag "${t}" must be in oneOf`,params:({params:{discrError:e,tag:t,tagName:r}})=>(0,yt._)`{error: ${e}, tag: ${r}, tagValue: ${t}}`},code(e){const{gen:t,data:r,schema:n,parentSchema:a,it:s}=e,{oneOf:l}=a;if(!s.opts.discriminator)throw new Error("discriminator: requires discriminator option");const f=n.propertyName;if(typeof f!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!l)throw new Error("discriminator: requires oneOf keyword");const d=t.let("valid",!1),u=t.const("tag",(0,yt._)`${r}${(0,yt.getProperty)(f)}`);t.if((0,yt._)`typeof ${u} == "string"`,()=>i(),()=>e.error(!1,{discrError:Tn.DiscrError.Tag,tag:u,tagName:f})),e.ok(d);function i(){const w=b();t.if(!1);for(const g in w)t.elseIf((0,yt._)`${u} === ${g}`),t.assign(d,p(w[g]));t.else(),e.error(!1,{discrError:Tn.DiscrError.Mapping,tag:u,tagName:f}),t.endIf()}function p(w){const g=t.name("valid"),_=e.subschema({keyword:"oneOf",schemaProp:w},g);return e.mergeEvaluated(_,yt.Name),g}function b(){var w;const g={},_=h(a);let $=!0;for(let R=0;R<l.length;R++){let D=l[R];D!=null&&D.$ref&&!(0,jc.schemaHasRulesButRef)(D,s.self.RULES)&&(D=Da.resolveRef.call(s.self,s.schemaEnv.root,s.baseId,D==null?void 0:D.$ref),D instanceof Da.SchemaEnv&&(D=D.schema));const E=(w=D==null?void 0:D.properties)===null||w===void 0?void 0:w[f];if(typeof E!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${f}"`);$=$&&(_||h(D)),P(E,R)}if(!$)throw new Error(`discriminator: "${f}" must be required`);return g;function h({required:R}){return Array.isArray(R)&&R.includes(f)}function P(R,D){if(R.const)O(R.const,D);else if(R.enum)for(const E of R.enum)O(E,D);else throw new Error(`discriminator: "properties/${f}" must have "const" or "enum"`)}function O(R,D){if(typeof R!="string"||R in g)throw new Error(`discriminator: "${f}" values must be unique strings`);g[R]=D}}}};Nn.default=Rc;const Ic={$schema:"http://json-schema.org/draft-07/schema#",$id:"http://json-schema.org/draft-07/schema#",title:"Core schema meta-schema",definitions:{schemaArray:{type:"array",minItems:1,items:{$ref:"#"}},nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{allOf:[{$ref:"#/definitions/nonNegativeInteger"},{default:0}]},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}},type:["object","boolean"],properties:{$id:{type:"string",format:"uri-reference"},$schema:{type:"string",format:"uri"},$ref:{type:"string",format:"uri-reference"},$comment:{type:"string"},title:{type:"string"},description:{type:"string"},default:!0,readOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/definitions/nonNegativeInteger"},minLength:{$ref:"#/definitions/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},additionalItems:{$ref:"#"},items:{anyOf:[{$ref:"#"},{$ref:"#/definitions/schemaArray"}],default:!0},maxItems:{$ref:"#/definitions/nonNegativeInteger"},minItems:{$ref:"#/definitions/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},contains:{$ref:"#"},maxProperties:{$ref:"#/definitions/nonNegativeInteger"},minProperties:{$ref:"#/definitions/nonNegativeIntegerDefault0"},required:{$ref:"#/definitions/stringArray"},additionalProperties:{$ref:"#"},definitions:{type:"object",additionalProperties:{$ref:"#"},default:{}},properties:{type:"object",additionalProperties:{$ref:"#"},default:{}},patternProperties:{type:"object",additionalProperties:{$ref:"#"},propertyNames:{format:"regex"},default:{}},dependencies:{type:"object",additionalProperties:{anyOf:[{$ref:"#"},{$ref:"#/definitions/stringArray"}]}},propertyNames:{$ref:"#"},const:!0,enum:{type:"array",items:!0,minItems:1,uniqueItems:!0},type:{anyOf:[{$ref:"#/definitions/simpleTypes"},{type:"array",items:{$ref:"#/definitions/simpleTypes"},minItems:1,uniqueItems:!0}]},format:{type:"string"},contentMediaType:{type:"string"},contentEncoding:{type:"string"},if:{$ref:"#"},then:{$ref:"#"},else:{$ref:"#"},allOf:{$ref:"#/definitions/schemaArray"},anyOf:{$ref:"#/definitions/schemaArray"},oneOf:{$ref:"#/definitions/schemaArray"},not:{$ref:"#"}},default:!0};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.MissingRefError=t.ValidationError=t.CodeGen=t.Name=t.nil=t.stringify=t.str=t._=t.KeywordCxt=void 0;const r=Mn,n=Wr,a=Nn,s=Ic,l=["/properties"],f="http://json-schema.org/draft-07/schema";class d extends r.default{_addVocabularies(){super._addVocabularies(),n.default.forEach(g=>this.addVocabulary(g)),this.opts.discriminator&&this.addKeyword(a.default)}_addDefaultMetaSchema(){if(super._addDefaultMetaSchema(),!this.opts.meta)return;const g=this.opts.$data?this.$dataMetaSchema(s,l):s;this.addMetaSchema(g,f,!1),this.refs["http://json-schema.org/schema"]=f}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(f)?f:void 0)}}e.exports=t=d,Object.defineProperty(t,"__esModule",{value:!0}),t.default=d;var u=Ne;Object.defineProperty(t,"KeywordCxt",{enumerable:!0,get:function(){return u.KeywordCxt}});var i=J;Object.defineProperty(t,"_",{enumerable:!0,get:function(){return i._}}),Object.defineProperty(t,"str",{enumerable:!0,get:function(){return i.str}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return i.stringify}}),Object.defineProperty(t,"nil",{enumerable:!0,get:function(){return i.nil}}),Object.defineProperty(t,"Name",{enumerable:!0,get:function(){return i.Name}}),Object.defineProperty(t,"CodeGen",{enumerable:!0,get:function(){return i.CodeGen}});var p=kt;Object.defineProperty(t,"ValidationError",{enumerable:!0,get:function(){return p.default}});var b=Dt;Object.defineProperty(t,"MissingRefError",{enumerable:!0,get:function(){return b.default}})})(gs,Nt);const Aa=An(Nt);var $r={},kc={get exports(){return $r},set exports(e){$r=e}},Ma={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatNames=e.fastFormats=e.fullFormats=void 0;function t(M,U){return{validate:M,compare:U}}e.fullFormats={date:t(s,l),time:t(d,u),"date-time":t(p,b),duration:/^P(?!$)((\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+S)?)?|(\d+W)?)$/,uri:_,"uri-reference":/^(?:[a-z][a-z0-9+\-.]*:)?(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'"()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'"()*+,;=:@]|%[0-9a-f]{2})*)*)?(?:\?(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'"()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i,"uri-template":/^(?:(?:[^\x00-\x20"'<>%\\^`{|}]|%[0-9a-f]{2})|\{[+#./;?&=,!@|]?(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?(?:,(?:[a-z0-9_]|%[0-9a-f]{2})+(?::[1-9][0-9]{0,3}|\*)?)*\})*$/i,url:/^(?:https?|ftp):\/\/(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)(?:\.(?:[a-z0-9\u{00a1}-\u{ffff}]+-)*[a-z0-9\u{00a1}-\u{ffff}]+)*(?:\.(?:[a-z\u{00a1}-\u{ffff}]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/iu,email:/^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,hostname:/^(?=.{1,253}\.?$)[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[-0-9a-z]{0,61}[0-9a-z])?)*\.?$/i,ipv4:/^(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)$/,ipv6:/^((([0-9a-f]{1,4}:){7}([0-9a-f]{1,4}|:))|(([0-9a-f]{1,4}:){6}(:[0-9a-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){5}(((:[0-9a-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9a-f]{1,4}:){4}(((:[0-9a-f]{1,4}){1,3})|((:[0-9a-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){3}(((:[0-9a-f]{1,4}){1,4})|((:[0-9a-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){2}(((:[0-9a-f]{1,4}){1,5})|((:[0-9a-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9a-f]{1,4}:){1}(((:[0-9a-f]{1,4}){1,6})|((:[0-9a-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9a-f]{1,4}){1,7})|((:[0-9a-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))$/i,regex:A,uuid:/^(?:urn:uuid:)?[0-9a-f]{8}-(?:[0-9a-f]{4}-){3}[0-9a-f]{12}$/i,"json-pointer":/^(?:\/(?:[^~/]|~0|~1)*)*$/,"json-pointer-uri-fragment":/^#(?:\/(?:[a-z0-9_\-.!$&'()*+,;:=@]|%[0-9a-f]{2}|~0|~1)*)*$/i,"relative-json-pointer":/^(?:0|[1-9][0-9]*)(?:#|(?:\/(?:[^~/]|~0|~1)*)*)$/,byte:h,int32:{type:"number",validate:R},int64:{type:"number",validate:D},float:{type:"number",validate:E},double:{type:"number",validate:E},password:!0,binary:!0},e.fastFormats={...e.fullFormats,date:t(/^\d\d\d\d-[0-1]\d-[0-3]\d$/,l),time:t(/^(?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)?$/i,u),"date-time":t(/^\d\d\d\d-[0-1]\d-[0-3]\d[t\s](?:[0-2]\d:[0-5]\d:[0-5]\d|23:59:60)(?:\.\d+)?(?:z|[+-]\d\d(?::?\d\d)?)$/i,b),uri:/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/)?[^\s]*$/i,"uri-reference":/^(?:(?:[a-z][a-z0-9+\-.]*:)?\/?\/)?(?:[^\\\s#][^\s#]*)?(?:#[^\\\s]*)?$/i,email:/^[a-z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?(?:\.[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?)*$/i},e.formatNames=Object.keys(e.fullFormats);function r(M){return M%4===0&&(M%100!==0||M%400===0)}const n=/^(\d\d\d\d)-(\d\d)-(\d\d)$/,a=[0,31,28,31,30,31,30,31,31,30,31,30,31];function s(M){const U=n.exec(M);if(!U)return!1;const B=+U[1],H=+U[2],de=+U[3];return H>=1&&H<=12&&de>=1&&de<=(H===2&&r(B)?29:a[H])}function l(M,U){if(M&&U)return M>U?1:M<U?-1:0}const f=/^(\d\d):(\d\d):(\d\d)(\.\d+)?(z|[+-]\d\d(?::?\d\d)?)?$/i;function d(M,U){const B=f.exec(M);if(!B)return!1;const H=+B[1],de=+B[2],ne=+B[3],Se=B[5];return(H<=23&&de<=59&&ne<=59||H===23&&de===59&&ne===60)&&(!U||Se!=="")}function u(M,U){if(!(M&&U))return;const B=f.exec(M),H=f.exec(U);if(B&&H)return M=B[1]+B[2]+B[3]+(B[4]||""),U=H[1]+H[2]+H[3]+(H[4]||""),M>U?1:M<U?-1:0}const i=/t|\s/i;function p(M){const U=M.split(i);return U.length===2&&s(U[0])&&d(U[1],!0)}function b(M,U){if(!(M&&U))return;const[B,H]=M.split(i),[de,ne]=U.split(i),Se=l(B,de);if(Se!==void 0)return Se||u(H,ne)}const w=/\/|:/,g=/^(?:[a-z][a-z0-9+\-.]*:)(?:\/?\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:]|%[0-9a-f]{2})*@)?(?:\[(?:(?:(?:(?:[0-9a-f]{1,4}:){6}|::(?:[0-9a-f]{1,4}:){5}|(?:[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){4}|(?:(?:[0-9a-f]{1,4}:){0,1}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){3}|(?:(?:[0-9a-f]{1,4}:){0,2}[0-9a-f]{1,4})?::(?:[0-9a-f]{1,4}:){2}|(?:(?:[0-9a-f]{1,4}:){0,3}[0-9a-f]{1,4})?::[0-9a-f]{1,4}:|(?:(?:[0-9a-f]{1,4}:){0,4}[0-9a-f]{1,4})?::)(?:[0-9a-f]{1,4}:[0-9a-f]{1,4}|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?))|(?:(?:[0-9a-f]{1,4}:){0,5}[0-9a-f]{1,4})?::[0-9a-f]{1,4}|(?:(?:[0-9a-f]{1,4}:){0,6}[0-9a-f]{1,4})?::)|[Vv][0-9a-f]+\.[a-z0-9\-._~!$&'()*+,;=:]+)\]|(?:(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(?:25[0-5]|2[0-4]\d|[01]?\d\d?)|(?:[a-z0-9\-._~!$&'()*+,;=]|%[0-9a-f]{2})*)(?::\d*)?(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*|\/(?:(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)?|(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})+(?:\/(?:[a-z0-9\-._~!$&'()*+,;=:@]|%[0-9a-f]{2})*)*)(?:\?(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?(?:#(?:[a-z0-9\-._~!$&'()*+,;=:@/?]|%[0-9a-f]{2})*)?$/i;function _(M){return w.test(M)&&g.test(M)}const $=/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/gm;function h(M){return $.lastIndex=0,$.test(M)}const P=-(2**31),O=2**31-1;function R(M){return Number.isInteger(M)&&M<=O&&M>=P}function D(M){return Number.isInteger(M)}function E(){return!0}const j=/[^\\]\\Z/;function A(M){if(j.test(M))return!1;try{return new RegExp(M),!0}catch{return!1}}})(Ma);var Va={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.formatLimitDefinition=void 0;const t=Nt,r=J,n=r.operators,a={formatMaximum:{okStr:"<=",ok:n.LTE,fail:n.GT},formatMinimum:{okStr:">=",ok:n.GTE,fail:n.LT},formatExclusiveMaximum:{okStr:"<",ok:n.LT,fail:n.GTE},formatExclusiveMinimum:{okStr:">",ok:n.GT,fail:n.LTE}},s={message:({keyword:f,schemaCode:d})=>r.str`should be ${a[f].okStr} ${d}`,params:({keyword:f,schemaCode:d})=>r._`{comparison: ${a[f].okStr}, limit: ${d}}`};e.formatLimitDefinition={keyword:Object.keys(a),type:"string",schemaType:"string",$data:!0,error:s,code(f){const{gen:d,data:u,schemaCode:i,keyword:p,it:b}=f,{opts:w,self:g}=b;if(!w.validateFormats)return;const _=new t.KeywordCxt(b,g.RULES.all.format.definition,"format");_.$data?$():h();function $(){const O=d.scopeValue("formats",{ref:g.formats,code:w.code.formats}),R=d.const("fmt",r._`${O}[${_.schemaCode}]`);f.fail$data(r.or(r._`typeof ${R} != "object"`,r._`${R} instanceof RegExp`,r._`typeof ${R}.compare != "function"`,P(R)))}function h(){const O=_.schema,R=g.formats[O];if(!R||R===!0)return;if(typeof R!="object"||R instanceof RegExp||typeof R.compare!="function")throw new Error(`"${p}": format "${O}" does not define "compare" function`);const D=d.scopeValue("formats",{key:O,ref:R,code:w.code.formats?r._`${w.code.formats}${r.getProperty(O)}`:void 0});f.fail$data(P(D))}function P(O){return r._`${O}.compare(${u}, ${i}) ${a[p].fail} 0`}},dependencies:["format"]};const l=f=>(f.addKeyword(e.formatLimitDefinition),f);e.default=l})(Va),function(e,t){Object.defineProperty(t,"__esModule",{value:!0});const r=Ma,n=Va,a=J,s=new a.Name("fullFormats"),l=new a.Name("fastFormats"),f=(u,i={keywords:!0})=>{if(Array.isArray(i))return d(u,i,r.fullFormats,s),u;const[p,b]=i.mode==="fast"?[r.fastFormats,l]:[r.fullFormats,s],w=i.formats||r.formatNames;return d(u,w,p,b),i.keywords&&n.default(u),u};f.get=(u,i="full")=>{const b=(i==="fast"?r.fastFormats:r.fullFormats)[u];if(!b)throw new Error(`Unknown format "${u}"`);return b};function d(u,i,p,b){var w,g;(w=(g=u.opts.code).formats)!==null&&w!==void 0||(g.formats=a._`require("ajv-formats/dist/formats").${b}`);for(const _ of i)u.addFormat(_,p[_])}e.exports=t=f,Object.defineProperty(t,"__esModule",{value:!0}),t.default=f}(kc,$r);const za=An($r);function Cn(e,t){const r={};for(const[n]of Object.entries(t||{}))r[n]=e[n];return r}function Dc(e,t){var b,w,g;let r={},n={};const a=e.namespace||"",s=()=>a?t[a]||{}:t;function l(_){return _.replace(/^\//,"").replace(/\//g,".")}const f=(_,$)=>{const h=new Aa({allErrors:!0,allowUnionTypes:!0});za(h);const P=h.compile(_);if(!P(s())){const R=P.errors;if(!R)throw new Error("Unknown error");const D=R[0],E=new Error(D.message);throw E.namespace=a,E.params=D.params,E.property=D.params.missingProperty??l(D.instancePath),E}};if(e.server&&Object.keys(e.server).length>0){try{f(e.server,"server")}catch($){throw $}const _=Cn(s(),e.server.properties);a?r[a]=_:r=_}if(e.client&&Object.keys(e.client).length>0){try{f(e.client,"client")}catch($){throw $}const _=Cn(s(),e.client.properties);a?n[a]=_:n=_}if(e["*"]&&Object.keys(e["*"]).length>0){const _=Cn(s(),e["*"].properties);try{f(e["*"],"both")}catch($){throw $}a?(r[a]={...r[a],..._},n[a]={...n[a],..._}):(r={...r,..._},n={...n,..._})}function d(_){if(_.type==="object"&&("additionalProperties"in _||(_.additionalProperties=!1),_.properties))for(const $ in _.properties)_.properties[$]=d(_.properties[$]);return _}function u(_,$){var R;const h=new Aa({allErrors:!0,allowUnionTypes:!0});za(h);const P=h.compile(d(_));if(P($))return[];{const D=[];return(R=P.errors)==null||R.forEach(E=>{var j;if(E.keyword==="additionalProperties"){const A=l(E.instancePath),M=A+(A?".":"")+((j=E.params)==null?void 0:j.additionalProperty);D.push(M)}}),D}}const i={...((b=e.server)==null?void 0:b.properties)||{},...((w=e.client)==null?void 0:w.properties)||{},...((g=e["*"])==null?void 0:g.properties)||{}},p=u({type:"object",properties:i},s()).filter(_=>_!=="modules").map(_=>a?`${a}.${_}`:_);return{server:r,client:n,namespace:a,extraProps:p}}const Ye={yellow:e=>e,blue:e=>e,red:e=>e,dim:e=>e},Ac={canvas:{type:"object",properties:{transparent:{type:"boolean"},autoDensity:{type:"boolean"},antialias:{type:"boolean"},resolution:{type:"number"},preserveDrawingBuffer:{type:"boolean"},backgroundColor:{type:"number"}}},selector:{type:"string"},selectorGui:{type:"string"},selectorCanvas:{type:"string"},standalone:{type:"boolean"},drawMap:{type:"boolean"},maxFps:{type:"number"},serverFps:{type:"number"}},Mc={server:{type:"object",properties:{startMap:{type:"string"},start:{type:"object",properties:{map:{type:"string"},graphic:{type:"string"},hitbox:{type:"array",items:[{type:"integer"},{type:"integer"}],additionalItems:!1,minItems:2,maxItems:2}}},spritesheetDirectories:{type:"array",items:{type:"string"}},api:{type:"object",properties:{enabled:{type:"boolean"},authSecret:{type:"string"}},required:["enabled","authSecret"]},...{compilerOptions:{type:"object",properties:{alias:{type:"object",additionalProperties:{type:"string"}},build:{type:"object",properties:{pwaEnabled:{type:"boolean"},assetsPath:{type:"string"},outputDir:{type:"string"},serverUrl:{type:"string"}}}}}}}},client:{type:"object",properties:{shortName:{type:"string"},description:{type:"string"},themeColor:{type:"string"},icons:{type:"array",items:{type:"object",properties:{src:{type:"string"},sizes:{type:"array",items:{type:"number",minimum:0}},type:{type:"string"}}}},themeCss:{type:"string"},matchMakerService:{type:"string"},pwa:{type:"object",additionalProperties:!0},...Ac}},"*":{type:"object",properties:{inputs:{type:"object",additionalProperties:{oneOf:[{type:"object",properties:{repeat:{type:"boolean",default:!1},bind:{type:["string","array"]},delay:{type:"object",properties:{duration:{type:"number",minimum:0},otherControls:{type:"array",items:{type:"string"}}},required:["duration"]}},required:["bind"]}]}},name:{type:"string"}}}},Vc=()=>{};function gr(e){console.log(Ye.yellow(`  Warning - ${e}`))}function zc(e,t,r){let n={},a={},s=[];const l=r.side=="server",f=r.mode||"development",d=(b,w)=>{try{const g=Dc(b,t);g.server&&(a={...a,...g.server}),g.client&&(n={...n,...g.client}),g.extraProps&&(s=[...s,...g.extraProps])}catch(g){if(!g.property)throw console.log(g),g;if(!l)return!1;let _=Ye.red(`Invalidate "${w}" module: ${g.message}`),$=`[${g.namespace}]
  ${g.property} = YOUR_VALUE`;throw w||(_=Ye.red(`Invalidate config: ${g.message}`),$=`${g.property} = YOUR_VALUE`),console.log("----------"),console.log(_),g.params.allowedValues&&console.log(`
${Ye.dim(" Authorize values:")} ${Ye.dim(g.params.allowedValues.join(", "))}`),console.log(`${Ye.dim("")} ${Ye.dim(`you need to put the following configuration in rpg.toml:

${$}`)}`),console.log("----------"),g}};d(Mc);let u=[];for(let b of e){let w=b;w[0]!="."&&(w=me.join("node_modules",w));const g=me.resolve(process.cwd(),w,"config.json");if(pe.existsSync(g)){const _=pe.readFileSync(g,"utf-8"),$=JSON.parse(_);$.namespace&&u.push($.namespace),d($,b)}}if(l){const b=s.filter(w=>u.indexOf(w)==-1);if(b.length>0){gr("In rpg.toml, you put the following properties, but they are not used by the modules. Check the names of the properties.");for(let w of b)console.log(`  - ${Ye.yellow(w)}`)}}function i(b,w){return b===null||typeof b!="object"?b:Array.isArray(b)?b.map(i):Object.entries(b).reduce((g,[_,$])=>{if($!==null&&typeof $=="object")$=i($,w);else if(typeof $=="string"&&$.startsWith("$ENV:")){const h=$.slice(5);$=w[h]}return g[_]=$,g},{})}const p=Vc(f,process.cwd());return{configClient:i(n,p),configServer:i(a,p)}}const Fc=e=>me.join(e,"assets");function _r(e){return e.replace(/\\/g,"/")}function Fa(e,t){const r=e.indexOf(t);if(r===-1)throw new Error("Project path not found in absolute path");return e.substring(r)}function Ua(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function La(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ua(Object(r),!0).forEach(function(n){Uc(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ua(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uc(e,t,r){return t=Lc(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lc(e){var t=qc(e,"string");return typeof t=="symbol"?t:String(t)}function qc(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}const Ke=qa({});function qa(e){return t.withOptions=r=>qa(La(La({},e),r)),t;function t(r,...n){const a=typeof r=="string"?[r]:r.raw,{escapeSpecialCharacters:s=Array.isArray(r)}=e;let l="";for(let u=0;u<a.length;u++){let i=a[u];s&&(i=i.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\{/g,"{")),l+=i,u<n.length&&(l+=n[u])}const f=l.split(`
`);let d=null;for(const u of f){const i=u.match(/^(\s+)\S+/);if(i){const p=i[1].length;d?d=Math.min(d,p):d=p}}if(d!==null){const u=d;l=f.map(i=>i[0]===" "||i[0]==="	"?i.slice(u):i).join(`
`)}return l.trim().replace(/\\n/g,`
`)}}var Ka=Object.freeze,Kc=Object.defineProperty,Hc=(e,t)=>Ka(Kc(e,"raw",{value:Ka(t||e.slice())})),Ha;const qt="virtual-modules",wr="virtual-config-client",br="virtual-config-server";function Er(e){return e=e.replace(/\./g,""),e.replace(/[.@\/ -]/g,"_")}function Ga(e){return e.startsWith("@rpgjs")||e.startsWith("rpgjs")?"node_modules/"+e:e}function Sr(e){const t=[],r=pe.readdirSync(e,{withFileTypes:!0});for(const n of r){const a=me.join(e,n.name);if(n.isDirectory()){const s=Sr(a);t.push(...s)}else t.push(a)}return t}function De(e,t,r,n,a){let s="";const l=me.resolve(t,e);return pe.existsSync(l)?{variablesString:Sr(l).filter(d=>typeof r=="string"?d.endsWith(r):r.some(u=>d.endsWith(u))).filter(d=>a!=null&&a.customFilter?a.customFilter(d):!0).map(d=>{const u=_r(d.replace(process.cwd(),".")),i=Er(u);return s=s+`
import ${i} from '${u}'`,n?n(u,i):i}).join(","),importString:s,folder:l}:{variablesString:"",importString:"",folder:""}}function vt(e,t,r){const n=me.resolve(process.cwd(),Ga(e),t+".ts");let a="";return pe.existsSync(n)&&(a=`import ${r||t} from '${e}/${t}.ts'`),a}function Wa(e,t,r){var g,_,$;const{modulesCreated:n}=t;n.includes(e)||n.push(e);const a=vt(e,"player"),s=vt(e,"server"),l=De("maps",e,".ts"),f=De("maps",e,".tmx",(h,P)=>`
            {
                id: '${h.replace(".tmx","")}',
                file: ${P}
            }
        `,{customFilter:h=>{const P=h.replace(".tmx",".ts");return!pe.existsSync(P)}}),d=!!(f!=null&&f.variablesString),u=De("worlds",e,".world"),i=De("database",e,".ts"),p=De("events",e,".ts"),b=(g=r.start)==null?void 0:g.hitbox;return`
        import { RpgServer, RpgModule } from '@rpgjs/server'
        ${f==null?void 0:f.importString}
        ${l==null?void 0:l.importString}
        ${u==null?void 0:u.importString}
        ${a||"const player = {}"}
        ${p==null?void 0:p.importString}
        ${i==null?void 0:i.importString}
        ${s}

        ${n.length==1?Ke`const _lastConnectedCb = player.onConnected
            player.onConnected = async (player) => {
                if (_lastConnectedCb) await _lastConnectedCb(player)
                if (!player.server.module.customHookExists('server.player.onAuth')) {
                    ${(_=r.start)!=null&&_.graphic?`player.setGraphic('${($=r.start)==null?void 0:$.graphic}')`:""}
                    ${b?`player.setHitbox(${b[0]}, ${b[1]})`:""}
                    ${r.startMap?`await player.changeMap('${r.startMap}')`:""}
                }
            }`:""}
           
        @RpgModule<RpgServer>({ 
            player,
            events: [${p==null?void 0:p.variablesString}],
            ${s?"engine: server,":""}
            database: [${i==null?void 0:i.variablesString}],
            maps: [${f==null?void 0:f.variablesString}${d?",":""}${l==null?void 0:l.variablesString}],
            worldMaps: [${u==null?void 0:u.variablesString}] 
        })
        export default class RpgServerModuleEngine {} 
    `}function Pr(e,t,r,n=!1){const a=De(e,t,".ts");let s="";if(a!=null&&a.importString){const l=a.folder;let f="",d="";const u=l.replace(process.cwd(),"/");if(Sr(l).filter(i=>[".png",".jpg",".jpeg",".gif",".bmp",".webp",".svg"].some(b=>i.toLowerCase().endsWith(b))).forEach(async i=>{const p=me.basename(i),b=p.replace(me.extname(i),"");if(r.serveMode===!1){const w=me.join(Fc(r.type==="rpg"?"standalone":"client"),p);pe.copyFileSync(i,w)}d=i,f+=`"${b}": "${_r(Fa(i,u.replace(/^\/+/,"")))}",
`}),!d)gr(`No spritesheet image found in ${e} folder`);else{const i=vs(d);s=`
            ${a==null?void 0:a.variablesString}.images = {
                ${f}
            }
            ${a==null?void 0:a.variablesString}.prototype.width = ${i.width}
            ${a==null?void 0:a.variablesString}.prototype.height = ${i.height}
        `}}else n&&gr(`No spritesheet folder found in ${e} folder`);return{...a,propImagesString:s}}function Ja(e,t,r){const n=vt(e,"scene-map","sceneMap"),a=vt(e,"sprite"),s=vt(e,"client","engine"),l=De("gui",e,".vue");let f=[];r.spritesheetDirectories&&(f=r.spritesheetDirectories.map(w=>Pr(w,e,t))),(r.spritesheetDirectories??[]).some(w=>w==="characters")||f.push(Pr("characters",e,t,!1));const d="spritesheets",u=me.join(e,d);if(pe.existsSync(u)){const w=pe.readdirSync(u,{withFileTypes:!0});for(const g of w)g.isDirectory()&&f.push(Pr(me.join(d,g.name),e,t))}const i=De("sounds",e,".ts"),p=De("sounds",e,[".mp3",".ogg"],void 0,{customFilter:w=>{const g=w.replace(/\.(mp3|ogg)$/,".ts");return!pe.existsSync(g)}}),b=!!(p!=null&&p.variablesString);return f=f.filter(w=>w.importString),Ke`
        import { RpgClient, RpgModule } from '@rpgjs/client'
        ${a}
        ${n}
        ${s}
        ${f.map(w=>w.importString).join(`
`)}
        ${l==null?void 0:l.importString}
        ${p==null?void 0:p.importString}
        ${i==null?void 0:i.importString}

        ${f.map(w=>w.propImagesString).join(`
`)}
        
        @RpgModule<RpgClient>({ 
            spritesheets: [ ${f.map(w=>w.variablesString).join(`,
`)} ],
            sprite: ${a?"sprite":"{}"},
            ${s?"engine,":""}
            scenes: { ${n?"map: sceneMap":""} },
            gui: [${l==null?void 0:l.variablesString}],
            sounds: [${p==null?void 0:p.variablesString}${b?",":""}${i==null?void 0:i.variablesString}]
        })
        export default class RpgClientModuleEngine {}
    `}function Ba(e,t,r,n,a){const s=`virtual-${t}-client.ts`,l=`virtual-${t}-server.ts`;if(e.endsWith(l+"?server"))return Wa(r,n,a);if(e.endsWith(s+"?client"))return Ja(r,n,a);const f=me.join(process.cwd(),e),d=me.join(f,"package.json"),u=me.join(f,"index.ts");if(pe.existsSync(d)){const{main:i}=JSON.parse(pe.readFileSync(d,"utf-8"));if(i){const p=_r(me.join(e,i));return Ke`
                import mod from '@/${p}'
                export default mod
            `}}else if(pe.existsSync(u)){const i=Fa(_r(u),e);return Ke`
            import mod from '@/${i}'
            export default mod
        `}return Ke`
        import client from 'client!./${s}'
        import server from 'server!./${l}'
        
        export default {
            client,
            server
        } 
    `}function Ya(e,t,r){return e.endsWith(br)?`
            export default ${JSON.stringify(t)}
        `:e.endsWith(wr)?`
            export default ${JSON.stringify(r)}
        `:null}function jn(e){return e.replace(/^.\//,"")}function Gc(e={},t){var f;let r=[],n=[];if(t.modules&&(r=t.modules),t.startMap=t.startMap||((f=t.start)==null?void 0:f.map),t.inputs&&e.server)for(let d in t.inputs){const u=t.inputs[d];(typeof u.bind=="string"?[u.bind]:u.bind).find(i=>["1","2","3","4"].includes(i))&&gr(`Input "${d}" : Note that 1, 2, 3 or 4 designates a direction. Use up, right, bottom or left instead. If you want the number key, use n1, n2, n<number>.`)}let a;try{a=zc(r,t,e)}catch{e.side=="server"&&process.exit()}if(!a)return;const{configClient:s,configServer:l}=a;return{name:"vite-plugin-config-toml",transformIndexHtml:{enforce:"pre",transform(d){const u=me.resolve(process.cwd(),"src","client.ts"),i=pe.existsSync(u)?"mmorpg!./src/client.ts":"mmorpg!virtual-client.ts",p=me.resolve(process.cwd(),"src","standalone.ts"),b=pe.existsSync(p)?"rpg!./src/standalone.ts":"rpg!virtual-standalone.ts";return d.replace("<head>",Ke(Ha||(Ha=Hc([`
                <head>
                <script type="module">
                    import '`,`'
                    import '`,`'
                <\/script>`])),i,b))}},handleHotUpdate(){n=[]},async resolveId(d,u){if(d.endsWith(qt)||d.endsWith(wr)||d.endsWith(br))return d;for(let i of r)if(d===jn(i))return d;if(d.includes("virtual")&&!d.endsWith("virtual-server.ts")&&e.serveMode||d.includes("virtual")&&!e.serveMode)return d},async load(d){const u=process.env.VITE_SERVER_URL,i=`{
                VITE_BUILT: ${process.env.VITE_BUILT},
                VITE_SERVER_URL: ${u?"'"+u+"'":"undefined"},
                VITE_RPG_TYPE: '${e.type??"mmorpg"}',
                VITE_ASSETS_PATH: '${process.env.VITE_ASSETS_PATH??""}'
            }`;if(d.endsWith(qt)){const b=r.reduce((w,g)=>{const _=Er(g);return w[_]=g,w},{});return`
                ${Object.keys(b).map(w=>`import ${w} from '${jn(b[w])}'`).join(`
`)}

                export default [
                   ${Object.keys(b).join(`,
`)}
                ]
                `}else{if(d.endsWith("virtual-client.ts?mmorpg"))return Ke`
                import { entryPoint } from '@rpgjs/client'
                import io from 'socket.io-client'
                import modules from './${qt}'
                import globalConfig from './${wr}'

                document.addEventListener('DOMContentLoaded', function(e) { 
                    entryPoint(modules, { 
                        io,
                        globalConfig,
                        envs: ${i}
                    }).start()
                });
              `;if(d.endsWith("virtual-standalone.ts?rpg"))return Ke`
                import { entryPoint } from '@rpgjs/standalone'
                import globalConfigClient from './${wr}'
                import globalConfigServer from './${br}'
                import modules from './${qt}'

                ${e.libMode?`  window.global ||= window
                 
                    export default (extraModules = []) => {
                        return entryPoint([
                            ...modules,
                            ...extraModules
                        ], {
                            globalConfigClient,
                            globalConfigServer,
                            envs: ${i}
                        })
                    }
                 `:`document.addEventListener('DOMContentLoaded', async function() { 
                        window.RpgStandalone = await entryPoint(modules, {
                            globalConfigClient,
                            globalConfigServer,
                            envs: ${i}
                        }).start() 
                    })`}

              `;if(d.endsWith("virtual-server.ts"))return Ke`
                import { expressServer } from '@rpgjs/server/express'
                import * as url from 'url'
                import modules from './${qt}'
                import globalConfig from './${br}'

                const __dirname = url.fileURLToPath(new URL('.', import.meta.url))

                expressServer(modules, {
                    globalConfig,
                    basePath: __dirname,
                    envs: ${i}
                })
              `}const p=Ya(d,l,s);if(p)return p;for(let b of r){let w=jn(b),g=Er(w);if(d.endsWith(w)||d.includes("virtual-"+g))return Ba(d,g,b,{...e,modulesCreated:n},t)}}}}const Wc=Object.freeze(Object.defineProperty({__proto__:null,createConfigFiles:Ya,createModuleLoad:Ba,default:Gc,formatVariableName:Er,getAllFiles:Sr,importString:vt,loadClientFiles:Ja,loadServerFiles:Wa,loadSpriteSheet:Pr,searchFolderAndTransformToImportString:De,transformPathIfModule:Ga},Symbol.toStringTag,{value:"Module"}));function Jc(e={}){const{side:t="client",mode:r="development",type:n="mmorpg"}=e;async function a(l,f,d){const u=["client!","server!","rpg!","mmorpg!","production!","development!"];for(const i of u)if(l.startsWith(i)){const p=l.replace(i,""),b=await this.resolve(p,f,{skipSelf:!0,...d});return{...b,id:b.id+`?${i.replace("!","")}`}}}async function s(l,f){let d=l;return r==="test"?{code:d,map:null}:((f.endsWith(t==="client"?"?server":"?client")&&n!=="rpg"||f.endsWith("?production")&&r!=="production"||f.endsWith("?development")&&r!=="development"||f.endsWith("?rpg")&&n!=="rpg"||f.endsWith("?mmorpg")&&n!=="mmorpg")&&(d="export default null;"),{code:d,map:null})}return{name:"transform-flag",resolveId:a,transform:s}}Qe.autoLoad=Wc,Qe.flagTransform=Jc,Object.defineProperty(Qe,Symbol.toStringTag,{value:"Module"})});
